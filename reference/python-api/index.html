<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Programmatic interface for depkeeper"><meta name=author content="Rahul Kaushal"><link href=https://rahulkaushal04.github.io/depkeeper/reference/python-api/ rel=canonical><link href=../cli-commands/ rel=prev><link href=../configuration-options/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Python API - depkeeper</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#python-api class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=depkeeper class="md-header__button md-logo" aria-label=depkeeper data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18s-.41-.06-.57-.18l-7.9-4.44A.99.99 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18s.41.06.57.18l7.9 4.44c.32.17.53.5.53.88zM12 4.15l-1.89 1.07L16 8.61l1.96-1.11zM6.04 7.5 12 10.85l1.96-1.1-5.88-3.4zM5 15.91l6 3.38v-6.71L5 9.21zm14 0v-6.7l-6 3.37v6.71z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> depkeeper </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Python API </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/rahulkaushal04/depkeeper title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> rahulkaushal04/depkeeper </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../getting-started/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../guides/ class=md-tabs__link> User Guide </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> <li class=md-tabs__item> <a href=../../community/ class=md-tabs__link> Community </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=depkeeper class="md-nav__button md-logo" aria-label=depkeeper data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18s-.41-.06-.57-.18l-7.9-4.44A.99.99 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18s.41.06.57.18l7.9 4.44c.32.17.53.5.53.88zM12 4.15l-1.89 1.07L16 8.61l1.96-1.11zM6.04 7.5 12 10.85l1.96-1.1-5.88-3.4zM5 15.91l6 3.38v-6.71L5 9.21zm14 0v-6.7l-6 3.37v6.71z"/></svg> </a> depkeeper </label> <div class=md-nav__source> <a href=https://github.com/rahulkaushal04/depkeeper title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> rahulkaushal04/depkeeper </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../../getting-started/ class="md-nav__link "> <span class=md-ellipsis> Getting Started </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/basic-usage/ class=md-nav__link> <span class=md-ellipsis> Basic Usage </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../guides/ class="md-nav__link "> <span class=md-ellipsis> User Guide </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../guides/checking-updates/ class=md-nav__link> <span class=md-ellipsis> Checking for Updates </span> </a> </li> <li class=md-nav__item> <a href=../../guides/updating-dependencies/ class=md-nav__link> <span class=md-ellipsis> Updating Dependencies </span> </a> </li> <li class=md-nav__item> <a href=../../guides/dependency-resolution/ class=md-nav__link> <span class=md-ellipsis> Dependency Resolution </span> </a> </li> <li class=md-nav__item> <a href=../../guides/ci-cd-integration/ class=md-nav__link> <span class=md-ellipsis> CI/CD Integration </span> </a> </li> <li class=md-nav__item> <a href=../../guides/configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../guides/best-practices/ class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> </li> <li class=md-nav__item> <a href=../../guides/troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Reference </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cli-commands/ class=md-nav__link> <span class=md-ellipsis> CLI Commands </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Python API </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Python API </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=#core-modules class=md-nav__link> <span class=md-ellipsis> Core Modules </span> </a> <nav class=md-nav aria-label="Core Modules"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#requirementsparser class=md-nav__link> <span class=md-ellipsis> RequirementsParser </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RequirementsParser </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> <nav class=md-nav aria-label=Functions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser.parse_file class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;parse_file </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser.parse_string class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;parse_string </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser.parse_line class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;parse_line </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser.get_constraints class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_constraints </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser.reset class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset </span> </a> </li> <li class=md-nav__item> <a href=#versionchecker class=md-nav__link> <span class=md-ellipsis> VersionChecker </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#depkeeper.core.VersionChecker class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;VersionChecker </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.VersionChecker-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> <nav class=md-nav aria-label=Functions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#depkeeper.core.VersionChecker.get_package_info class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_package_info </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.VersionChecker.check_packages class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_packages </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.VersionChecker.extract_current_version class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extract_current_version </span> </a> </li> <li class=md-nav__item> <a href=#pypidatastore class=md-nav__link> <span class=md-ellipsis> PyPIDataStore </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PyPIDataStore </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> <nav class=md-nav aria-label=Functions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore.get_package_data class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_package_data </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore.prefetch_packages class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;prefetch_packages </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore.get_version_dependencies class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_version_dependencies </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore.get_cached_package class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_cached_package </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore.get_versions class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_versions </span> </a> </li> <li class=md-nav__item> <a href=#pypipackagedata class=md-nav__link> <span class=md-ellipsis> PyPIPackageData </span> </a> </li> <li class=md-nav__item> <a href=#dependencyanalyzer class=md-nav__link> <span class=md-ellipsis> DependencyAnalyzer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#depkeeper.core.DependencyAnalyzer class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DependencyAnalyzer </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.DependencyAnalyzer-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> <nav class=md-nav aria-label=Functions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#depkeeper.core.DependencyAnalyzer.resolve_and_annotate_conflicts class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;resolve_and_annotate_conflicts </span> </a> </li> <li class=md-nav__item> <a href=#resolutionresult class=md-nav__link> <span class=md-ellipsis> ResolutionResult </span> </a> </li> <li class=md-nav__item> <a href=#packageresolution class=md-nav__link> <span class=md-ellipsis> PackageResolution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#models class=md-nav__link> <span class=md-ellipsis> Models </span> </a> <nav class=md-nav aria-label=Models> <ul class=md-nav__list> <li class=md-nav__item> <a href=#requirement class=md-nav__link> <span class=md-ellipsis> Requirement </span> </a> </li> <li class=md-nav__item> <a href=#package class=md-nav__link> <span class=md-ellipsis> Package </span> </a> </li> <li class=md-nav__item> <a href=#conflict class=md-nav__link> <span class=md-ellipsis> Conflict </span> </a> </li> <li class=md-nav__item> <a href=#conflictset class=md-nav__link> <span class=md-ellipsis> ConflictSet </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#utilities class=md-nav__link> <span class=md-ellipsis> Utilities </span> </a> <nav class=md-nav aria-label=Utilities> <ul class=md-nav__list> <li class=md-nav__item> <a href=#httpclient class=md-nav__link> <span class=md-ellipsis> HTTPClient </span> </a> </li> <li class=md-nav__item> <a href=#console-utilities class=md-nav__link> <span class=md-ellipsis> Console Utilities </span> </a> </li> <li class=md-nav__item> <a href=#filesystem-utilities class=md-nav__link> <span class=md-ellipsis> Filesystem Utilities </span> </a> </li> <li class=md-nav__item> <a href=#logging-utilities class=md-nav__link> <span class=md-ellipsis> Logging Utilities </span> </a> </li> <li class=md-nav__item> <a href=#version-utilities class=md-nav__link> <span class=md-ellipsis> Version Utilities </span> </a> </li> <li class=md-nav__item> <a href=#exceptions class=md-nav__link> <span class=md-ellipsis> Exceptions </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#complete-example class=md-nav__link> <span class=md-ellipsis> Complete Example </span> </a> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../configuration-options/ class=md-nav__link> <span class=md-ellipsis> Configuration Options </span> </a> </li> <li class=md-nav__item> <a href=../exit-codes/ class=md-nav__link> <span class=md-ellipsis> Exit Codes </span> </a> </li> <li class=md-nav__item> <a href=../file-formats/ class=md-nav__link> <span class=md-ellipsis> File Formats </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../contributing/ class="md-nav__link "> <span class=md-ellipsis> Contributing </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contributing/development-setup/ class=md-nav__link> <span class=md-ellipsis> Development Setup </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/code-style/ class=md-nav__link> <span class=md-ellipsis> Code Style </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/testing/ class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/release-process/ class=md-nav__link> <span class=md-ellipsis> Release Process </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../community/ class="md-nav__link "> <span class=md-ellipsis> Community </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Community </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../community/faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=../../community/changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../community/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class=md-nav__item> <a href=../../community/code-of-conduct/ class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> <li class=md-nav__item> <a href=../../community/security/ class=md-nav__link> <span class=md-ellipsis> Security Policy </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=#core-modules class=md-nav__link> <span class=md-ellipsis> Core Modules </span> </a> <nav class=md-nav aria-label="Core Modules"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#requirementsparser class=md-nav__link> <span class=md-ellipsis> RequirementsParser </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;RequirementsParser </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> <nav class=md-nav aria-label=Functions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser.parse_file class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;parse_file </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser.parse_string class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;parse_string </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser.parse_line class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;parse_line </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser.get_constraints class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_constraints </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.RequirementsParser.reset class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;reset </span> </a> </li> <li class=md-nav__item> <a href=#versionchecker class=md-nav__link> <span class=md-ellipsis> VersionChecker </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#depkeeper.core.VersionChecker class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;VersionChecker </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.VersionChecker-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> <nav class=md-nav aria-label=Functions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#depkeeper.core.VersionChecker.get_package_info class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_package_info </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.VersionChecker.check_packages class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_packages </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.VersionChecker.extract_current_version class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extract_current_version </span> </a> </li> <li class=md-nav__item> <a href=#pypidatastore class=md-nav__link> <span class=md-ellipsis> PyPIDataStore </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PyPIDataStore </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> <nav class=md-nav aria-label=Functions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore.get_package_data class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_package_data </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore.prefetch_packages class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;prefetch_packages </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore.get_version_dependencies class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_version_dependencies </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore.get_cached_package class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_cached_package </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.PyPIDataStore.get_versions class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_versions </span> </a> </li> <li class=md-nav__item> <a href=#pypipackagedata class=md-nav__link> <span class=md-ellipsis> PyPIPackageData </span> </a> </li> <li class=md-nav__item> <a href=#dependencyanalyzer class=md-nav__link> <span class=md-ellipsis> DependencyAnalyzer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#depkeeper.core.DependencyAnalyzer class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;DependencyAnalyzer </span> </a> </li> <li class=md-nav__item> <a href=#depkeeper.core.DependencyAnalyzer-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> <nav class=md-nav aria-label=Functions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#depkeeper.core.DependencyAnalyzer.resolve_and_annotate_conflicts class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;resolve_and_annotate_conflicts </span> </a> </li> <li class=md-nav__item> <a href=#resolutionresult class=md-nav__link> <span class=md-ellipsis> ResolutionResult </span> </a> </li> <li class=md-nav__item> <a href=#packageresolution class=md-nav__link> <span class=md-ellipsis> PackageResolution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#models class=md-nav__link> <span class=md-ellipsis> Models </span> </a> <nav class=md-nav aria-label=Models> <ul class=md-nav__list> <li class=md-nav__item> <a href=#requirement class=md-nav__link> <span class=md-ellipsis> Requirement </span> </a> </li> <li class=md-nav__item> <a href=#package class=md-nav__link> <span class=md-ellipsis> Package </span> </a> </li> <li class=md-nav__item> <a href=#conflict class=md-nav__link> <span class=md-ellipsis> Conflict </span> </a> </li> <li class=md-nav__item> <a href=#conflictset class=md-nav__link> <span class=md-ellipsis> ConflictSet </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#utilities class=md-nav__link> <span class=md-ellipsis> Utilities </span> </a> <nav class=md-nav aria-label=Utilities> <ul class=md-nav__list> <li class=md-nav__item> <a href=#httpclient class=md-nav__link> <span class=md-ellipsis> HTTPClient </span> </a> </li> <li class=md-nav__item> <a href=#console-utilities class=md-nav__link> <span class=md-ellipsis> Console Utilities </span> </a> </li> <li class=md-nav__item> <a href=#filesystem-utilities class=md-nav__link> <span class=md-ellipsis> Filesystem Utilities </span> </a> </li> <li class=md-nav__item> <a href=#logging-utilities class=md-nav__link> <span class=md-ellipsis> Logging Utilities </span> </a> </li> <li class=md-nav__item> <a href=#version-utilities class=md-nav__link> <span class=md-ellipsis> Version Utilities </span> </a> </li> <li class=md-nav__item> <a href=#exceptions class=md-nav__link> <span class=md-ellipsis> Exceptions </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#complete-example class=md-nav__link> <span class=md-ellipsis> Complete Example </span> </a> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=../.. class=md-path__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-path__item> <a href=../ class=md-path__link> <span class=md-ellipsis> Reference </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <a href=https://github.com/rahulkaushal04/depkeeper/edit/main/docs/reference/python-api.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <a href=https://github.com/rahulkaushal04/depkeeper/raw/main/docs/reference/python-api.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg> </a> <h1 id=python-api>Python <abbr title="Application Programming Interface">API</abbr><a class=headerlink href=#python-api title="Link to this section">&para;</a></h1> <p>Use depkeeper programmatically in your Python scripts and tools. This page documents the core modules, data models, and utility functions available for integration.</p> <hr> <h2 id=overview>Overview<a class=headerlink href=#overview title="Link to this section">&para;</a></h2> <p><strong>Core pipeline:</strong></p> <table> <thead> <tr> <th>Step</th> <th>Module</th> <th>Input</th> <th>Output</th> </tr> </thead> <tbody> <tr> <td>1</td> <td><code>RequirementsParser</code></td> <td>requirements file</td> <td><code>List[Requirement]</code></td> </tr> <tr> <td>2</td> <td><code>VersionChecker</code></td> <td><code>List[Requirement]</code></td> <td><code>List[Package]</code></td> </tr> <tr> <td>3</td> <td><code>DependencyAnalyzer</code></td> <td><code>List[Package]</code></td> <td><code>ResolutionResult</code></td> </tr> <tr> <td>4</td> <td>Apply / Report</td> <td><code>ResolutionResult</code></td> <td>Updated file or report</td> </tr> </tbody> </table> <p><code>PyPIDataStore</code> backs both <code>VersionChecker</code> and <code>DependencyAnalyzer</code>, and is itself backed by <code>HTTPClient</code>.</p> <p>depkeeper provides a Python <abbr title="Application Programming Interface">API</abbr> for:</p> <ul> <li>Parsing <code>requirements.txt</code> files into structured <code>Requirement</code> objects</li> <li>Checking package versions against <abbr title="Python Package Index">PyPI</abbr> with strict major version boundaries</li> <li>Resolving dependency conflicts through iterative analysis</li> <li>Formatting and displaying results</li> </ul> <p>All core modules share a single <code>PyPIDataStore</code> instance to ensure each package is fetched at most once per process.</p> <hr> <h2 id=quick-start>Quick Start<a class=headerlink href=#quick-start title="Link to this section">&para;</a></h2> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>asyncio</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.core</span><span class=w> </span><span class=kn>import</span> <span class=n>RequirementsParser</span><span class=p>,</span> <span class=n>VersionChecker</span><span class=p>,</span> <span class=n>PyPIDataStore</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>HTTPClient</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>check_requirements</span><span class=p>():</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>    <span class=c1># Parse requirements file</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>    <span class=n>parser</span> <span class=o>=</span> <span class=n>RequirementsParser</span><span class=p>()</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>    <span class=n>requirements</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_file</span><span class=p>(</span><span class=s2>&quot;requirements.txt&quot;</span><span class=p>)</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>    <span class=c1># Check versions</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>    <span class=k>async</span> <span class=k>with</span> <span class=n>HTTPClient</span><span class=p>()</span> <span class=k>as</span> <span class=n>http</span><span class=p>:</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>        <span class=n>store</span> <span class=o>=</span> <span class=n>PyPIDataStore</span><span class=p>(</span><span class=n>http</span><span class=p>)</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>        <span class=n>checker</span> <span class=o>=</span> <span class=n>VersionChecker</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=n>store</span><span class=p>)</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>        <span class=n>packages</span> <span class=o>=</span> <span class=k>await</span> <span class=n>checker</span><span class=o>.</span><span class=n>check_packages</span><span class=p>(</span><span class=n>requirements</span><span class=p>)</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>    <span class=c1># Report</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>    <span class=k>for</span> <span class=n>pkg</span> <span class=ow>in</span> <span class=n>packages</span><span class=p>:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>        <span class=k>if</span> <span class=n>pkg</span><span class=o>.</span><span class=n>has_update</span><span class=p>():</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>pkg</span><span class=o>.</span><span class=n>current_version</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=n>pkg</span><span class=o>.</span><span class=n>recommended_version</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>check_requirements</span><span class=p>())</span>
</span></code></pre></div> <hr> <h2 id=core-modules>Core Modules<a class=headerlink href=#core-modules title="Link to this section">&para;</a></h2> <h3 id=requirementsparser>RequirementsParser<a class=headerlink href=#requirementsparser title="Link to this section">&para;</a></h3> <p>Stateful parser for pip-style requirements files. Supports all <abbr title="Python Enhancement Proposal">PEP</abbr> 440/508 syntax including version specifiers, extras, environment markers, include directives (<code>-r</code>), constraint files (<code>-c</code>), <abbr title="Version Control System">VCS</abbr> URLs, editable installs, and hash verification.</p> <p>The parser maintains internal state across multiple <code>parse_file</code> calls:</p> <ul> <li><strong>Include stack</strong> -- tracks the chain of <code>-r</code> directives to detect circular dependencies</li> <li><strong>Constraint map</strong> -- stores requirements loaded via <code>-c</code> directives</li> </ul> <p>Call <code>reset()</code> to clear state before reusing the parser on an unrelated set of files.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.core</span><span class=w> </span><span class=kn>import</span> <span class=n>RequirementsParser</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=n>parser</span> <span class=o>=</span> <span class=n>RequirementsParser</span><span class=p>()</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=c1># Parse from file</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=n>requirements</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_file</span><span class=p>(</span><span class=s2>&quot;requirements.txt&quot;</span><span class=p>)</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=c1># Parse from string</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=n>content</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=s2>requests&gt;=2.28.0</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=s2>flask==2.3.0</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=s2>-r base.txt</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=n>requirements</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_string</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=n>source_file_path</span><span class=o>=</span><span class=s2>&quot;inline&quot;</span><span class=p>)</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=c1># Access constraint files loaded via -c</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=n>constraints</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>get_constraints</span><span class=p>()</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=c1># Reset state before reusing</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=n>parser</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
</span></code></pre></div> <h4 id=methods>Methods<a class=headerlink href=#methods title="Link to this section">&para;</a></h4> <div class="doc doc-object doc-class"> <a id=depkeeper.core.RequirementsParser></a> <div class="doc doc-contents first"> <p>Stateful parser for pip-style requirements files.</p> <p>Maintains two pieces of internal state across multiple <code>parse_file</code> calls:</p> <ol> <li><strong>Include stack</strong>  tracks the chain of <code>-r</code> directives to detect circular dependencies.</li> <li><strong>Constraint map</strong>  stores all requirements loaded via <code>-c</code> directives; these are applied to matching package names during parsing.</li> </ol> <p>Call :meth:<code>reset</code> to clear state before reusing the parser on an unrelated set of files.</p> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; parser = RequirementsParser()
&gt;&gt;&gt; reqs = parser.parse_file(&quot;requirements.txt&quot;)
&gt;&gt;&gt; len(reqs)
42
&gt;&gt;&gt; parser.get_constraints()
{&#39;django&#39;: &lt;Requirement django==3.2&gt;}
&gt;&gt;&gt; parser.reset()
</code></pre></div> <p>Initialise the parser with empty state.</p> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/parser.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Initialise the parser with empty state.&quot;&quot;&quot;</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;parser&quot;</span><span class=p>)</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a>    <span class=c1># Stack of files currently being parsed (guards against cycles)</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_included_files_stack</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>    <span class=c1># Constraint requirements loaded via -c directives</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_constraint_requirements</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Requirement</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <h2 id=depkeeper.core.RequirementsParser-functions>Functions<a href=#depkeeper.core.RequirementsParser-functions class=headerlink title="Link to this section">&para;</a></h2> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.RequirementsParser.parse_file class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">parse_file</span> <a href=#depkeeper.core.RequirementsParser.parse_file class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>parse_file</span><span class=p>(</span><span class=n>file_path</span><span class=p>:</span> <span class=n><span title=typing.Union>Union</span></span><span class=p>[</span><span class=n><span title=str>str</span></span><span class=p>,</span> <span class=n><span title=pathlib.Path>Path</span></span><span class=p>],</span> <span class=n>is_constraint_file</span><span class=p>:</span> <span class=n><span title=bool>bool</span></span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>_parent_directory_path</span><span class=p>:</span> <span class=n><span title=typing.Optional>Optional</span></span><span class=p>[</span><span class=n><span title=pathlib.Path>Path</span></span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=typing.List>List</span></span><span class=p>[</span><span class=n><span title=depkeeper.models.requirement.Requirement>Requirement</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Parse a requirements file from disk.</p> <p>Reads the file at <em>file_path</em>, processes all directives (<code>-r</code>, <code>-c</code>, <code>-e</code>, <code>--hash</code>), and returns a flat list of :class:<code>Requirement</code> objects. If <em>file_path</em> is relative and <em>_parent_directory_path</em> is provided (internal use by <code>-r</code>), the path is resolved relative to the parent.</p> <p>Circular include chains (<code>A.txt</code> includes <code>B.txt</code> which includes <code>A.txt</code>) are detected and raise :exc:<code>ParseError</code>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>file_path</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Path to the requirements file (absolute or relative).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=typing.Union>Union</span>[<span title=str>str</span>, <span title=pathlib.Path>Path</span>]</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>is_constraint_file</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>If <code>True</code>, all parsed requirements are stored as constraints (via :attr:<code>_constraint_requirements</code>) rather than returned. Used internally by <code>-c</code> handlers.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=bool>bool</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>_parent_directory_path</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Internal parameter used when resolving <code>-r</code> includes; the parent's directory is used as the base for relative paths.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=typing.Optional>Optional</span>[<span title=pathlib.Path>Path</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.List>List</span>[<span title=depkeeper.models.requirement.Requirement>Requirement</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>List of :class:<code>Requirement</code> objects (empty if</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.List>List</span>[<span title=depkeeper.models.requirement.Requirement>Requirement</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p><em>is_constraint_file</em> is <code>True</code>).</p> </div> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><span title=depkeeper.exceptions.FileOperationError>FileOperationError</span></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>The file does not exist or cannot be read.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><span title=depkeeper.exceptions.ParseError>ParseError</span></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>A circular include was detected or the file contains invalid syntax.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; parser = RequirementsParser()
&gt;&gt;&gt; reqs = parser.parse_file(&quot;requirements/prod.txt&quot;)
&gt;&gt;&gt; [r.name for r in reqs if r.editable]
[&#39;my-local-package&#39;]
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/parser.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=k>def</span><span class=w> </span><span class=nf>parse_file</span><span class=p>(</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>    <span class=n>file_path</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Path</span><span class=p>],</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>    <span class=n>is_constraint_file</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>    <span class=n>_parent_directory_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Path</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Requirement</span><span class=p>]:</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Parse a requirements file from disk.</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>    Reads the file at *file_path*, processes all directives (``-r``,</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><span class=sd>    ``-c``, ``-e``, ``--hash``), and returns a flat list of</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>    :class:`Requirement` objects.  If *file_path* is relative and</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><span class=sd>    *_parent_directory_path* is provided (internal use by ``-r``), the</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>    path is resolved relative to the parent.</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><span class=sd>    Circular include chains (``A.txt`` includes ``B.txt`` which</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=sd>    includes ``A.txt``) are detected and raise :exc:`ParseError`.</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=sd>    Args:</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><span class=sd>        file_path: Path to the requirements file (absolute or relative).</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><span class=sd>        is_constraint_file: If ``True``, all parsed requirements are</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><span class=sd>            stored as constraints (via :attr:`_constraint_requirements`)</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><span class=sd>            rather than returned.  Used internally by ``-c`` handlers.</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=sd>        _parent_directory_path: Internal parameter used when resolving</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>            ``-r`` includes; the parent&#39;s directory is used as the base</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=sd>            for relative paths.</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>    Returns:</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>        List of :class:`Requirement` objects (empty if</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>        *is_constraint_file* is ``True``).</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>    Raises:</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>        FileOperationError: The file does not exist or cannot be read.</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>        ParseError: A circular include was detected or the file contains</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>            invalid syntax.</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>    Example::</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>        &gt;&gt;&gt; parser = RequirementsParser()</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>        &gt;&gt;&gt; reqs = parser.parse_file(&quot;requirements/prod.txt&quot;)</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>        &gt;&gt;&gt; [r.name for r in reqs if r.editable]</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=sd>        [&#39;my-local-package&#39;]</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>    <span class=n>resolved_path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_resolve_file_path</span><span class=p>(</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>        <span class=n>file_path</span><span class=o>=</span><span class=n>Path</span><span class=p>(</span><span class=n>file_path</span><span class=p>),</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>        <span class=n>parent_directory</span><span class=o>=</span><span class=n>_parent_directory_path</span><span class=p>,</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>    <span class=p>)</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>        <span class=s2>&quot;Parsing file: </span><span class=si>%s%s</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>        <span class=n>resolved_path</span><span class=p>,</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>        <span class=s2>&quot; (constraint file)&quot;</span> <span class=k>if</span> <span class=n>is_constraint_file</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>    <span class=p>)</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>    <span class=c1># Detect circular includes before reading</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>    <span class=k>if</span> <span class=n>resolved_path</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_included_files_stack</span><span class=p>:</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>        <span class=n>cycle_path</span> <span class=o>=</span> <span class=s2>&quot; -&gt; &quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>            <span class=nb>str</span><span class=p>(</span><span class=n>p</span><span class=p>)</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_included_files_stack</span> <span class=o>+</span> <span class=p>[</span><span class=n>resolved_path</span><span class=p>]</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>        <span class=p>)</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&quot;Circular dependency detected: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>cycle_path</span><span class=p>)</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a>        <span class=k>raise</span> <span class=n>ParseError</span><span class=p>(</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>            <span class=sa>f</span><span class=s2>&quot;Circular dependency detected: </span><span class=si>{</span><span class=n>cycle_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a>            <span class=n>file_path</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>resolved_path</span><span class=p>),</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>        <span class=p>)</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a>    <span class=n>file_content</span> <span class=o>=</span> <span class=n>safe_read_file</span><span class=p>(</span><span class=n>resolved_path</span><span class=p>)</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_included_files_stack</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>resolved_path</span><span class=p>)</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>parse_string</span><span class=p>(</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>            <span class=n>file_content</span><span class=p>,</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a>            <span class=n>source_file_path</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>resolved_path</span><span class=p>),</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a>            <span class=n>is_constraint_file</span><span class=o>=</span><span class=n>is_constraint_file</span><span class=p>,</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>            <span class=n>_current_directory_path</span><span class=o>=</span><span class=n>resolved_path</span><span class=p>,</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a>        <span class=p>)</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a>            <span class=s2>&quot;Parsed </span><span class=si>%d</span><span class=s2> requirement(s) from </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>            <span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=p>),</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a>            <span class=n>resolved_path</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>        <span class=p>)</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>        <span class=k>return</span> <span class=n>result</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>    <span class=k>finally</span><span class=p>:</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_included_files_stack</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.RequirementsParser.parse_string class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">parse_string</span> <a href=#depkeeper.core.RequirementsParser.parse_string class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>parse_string</span><span class=p>(</span><span class=n>requirements_content</span><span class=p>:</span> <span class=n><span title=str>str</span></span><span class=p>,</span> <span class=n>source_file_path</span><span class=p>:</span> <span class=n><span title=typing.Optional>Optional</span></span><span class=p>[</span><span class=n><span title=str>str</span></span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=n>is_constraint_file</span><span class=p>:</span> <span class=n><span title=bool>bool</span></span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>_current_directory_path</span><span class=p>:</span> <span class=n><span title=typing.Optional>Optional</span></span><span class=p>[</span><span class=n><span title=pathlib.Path>Path</span></span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=typing.List>List</span></span><span class=p>[</span><span class=n><span title=depkeeper.models.requirement.Requirement>Requirement</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Parse requirements from raw text content.</p> <p>Splits <em>requirements_content</em> into lines and processes each via :meth:<code>parse_line</code>. Requirements loaded from <code>-r</code> includes are flattened into the result list.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>requirements_content</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Multi-line requirements text.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=str>str</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>source_file_path</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional file path for error messages (purely informational; does not affect parsing).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=typing.Optional>Optional</span>[<span title=str>str</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>is_constraint_file</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>If <code>True</code>, all parsed requirements are stored in :attr:<code>_constraint_requirements</code> instead of being returned.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=bool>bool</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>_current_directory_path</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Internal parameter; the directory containing the "file" being parsed (used to resolve relative <code>-r</code> / <code>-c</code> paths).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=typing.Optional>Optional</span>[<span title=pathlib.Path>Path</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.List>List</span>[<span title=depkeeper.models.requirement.Requirement>Requirement</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>List of :class:<code>Requirement</code> objects.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; content = &quot;&quot;&quot;
... flask&gt;=2.0
... # A comment
... requests&gt;=2.25.0
... &quot;&quot;&quot;
&gt;&gt;&gt; parser = RequirementsParser()
&gt;&gt;&gt; reqs = parser.parse_string(content)
&gt;&gt;&gt; [r.name for r in reqs]
[&#39;flask&#39;, &#39;requests&#39;]
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/parser.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=k>def</span><span class=w> </span><span class=nf>parse_string</span><span class=p>(</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>    <span class=n>requirements_content</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>    <span class=n>source_file_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>    <span class=n>is_constraint_file</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>    <span class=n>_current_directory_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Path</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Requirement</span><span class=p>]:</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Parse requirements from raw text content.</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a><span class=sd>    Splits *requirements_content* into lines and processes each via</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a><span class=sd>    :meth:`parse_line`.  Requirements loaded from ``-r`` includes are</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a><span class=sd>    flattened into the result list.</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a><span class=sd>    Args:</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a><span class=sd>        requirements_content: Multi-line requirements text.</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a><span class=sd>        source_file_path: Optional file path for error messages (purely</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a><span class=sd>            informational; does not affect parsing).</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a><span class=sd>        is_constraint_file: If ``True``, all parsed requirements are</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a><span class=sd>            stored in :attr:`_constraint_requirements` instead of being</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a><span class=sd>            returned.</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a><span class=sd>        _current_directory_path: Internal parameter; the directory</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a><span class=sd>            containing the &quot;file&quot; being parsed (used to resolve</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a><span class=sd>            relative ``-r`` / ``-c`` paths).</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=sd>    Returns:</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a><span class=sd>        List of :class:`Requirement` objects.</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a><span class=sd>    Example::</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a><span class=sd>        &gt;&gt;&gt; content = \&quot;\&quot;\&quot;</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a><span class=sd>        ... flask&gt;=2.0</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=sd>        ... # A comment</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a><span class=sd>        ... requests&gt;=2.25.0</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=sd>        ... \&quot;\&quot;\&quot;</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=sd>        &gt;&gt;&gt; parser = RequirementsParser()</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>        &gt;&gt;&gt; reqs = parser.parse_string(content)</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a><span class=sd>        &gt;&gt;&gt; [r.name for r in reqs]</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><span class=sd>        [&#39;flask&#39;, &#39;requests&#39;]</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a>    <span class=n>parsed_requirements</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Requirement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a>    <span class=n>total_lines</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>requirements_content</span><span class=o>.</span><span class=n>splitlines</span><span class=p>())</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>        <span class=s2>&quot;Parsing </span><span class=si>%d</span><span class=s2> line(s)</span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>        <span class=n>total_lines</span><span class=p>,</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>        <span class=sa>f</span><span class=s2>&quot; from </span><span class=si>{</span><span class=n>source_file_path</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>if</span> <span class=n>source_file_path</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>    <span class=p>)</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>    <span class=k>for</span> <span class=n>line_number</span><span class=p>,</span> <span class=n>line_text</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>        <span class=n>requirements_content</span><span class=o>.</span><span class=n>splitlines</span><span class=p>(),</span> <span class=n>start</span><span class=o>=</span><span class=mi>1</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>    <span class=p>):</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>        <span class=n>parse_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>parse_line</span><span class=p>(</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>            <span class=n>line_text</span><span class=p>,</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>            <span class=n>line_number</span><span class=p>,</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>            <span class=n>source_file_path</span><span class=p>,</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>            <span class=n>_current_directory_path</span><span class=o>=</span><span class=n>_current_directory_path</span><span class=p>,</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>        <span class=p>)</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>        <span class=k>if</span> <span class=n>parse_result</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>            <span class=c1># Comment or blank line</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>            <span class=k>continue</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>parse_result</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>            <span class=c1># Nested requirements from -r directive</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>                <span class=s2>&quot;Included </span><span class=si>%d</span><span class=s2> requirement(s) from directive on line </span><span class=si>%d</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a>                <span class=nb>len</span><span class=p>(</span><span class=n>parse_result</span><span class=p>),</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a>                <span class=n>line_number</span><span class=p>,</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a>            <span class=p>)</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a>            <span class=n>parsed_requirements</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>parse_result</span><span class=p>)</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>parse_result</span><span class=p>,</span> <span class=n>Requirement</span><span class=p>):</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>            <span class=k>if</span> <span class=n>is_constraint_file</span><span class=p>:</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>                <span class=c1># Store in constraint map instead of returning</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>                <span class=bp>self</span><span class=o>.</span><span class=n>_constraint_requirements</span><span class=p>[</span><span class=n>parse_result</span><span class=o>.</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>parse_result</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>                    <span class=s2>&quot;Stored constraint: </span><span class=si>%s</span><span class=s2> </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>                    <span class=n>parse_result</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>                    <span class=n>parse_result</span><span class=o>.</span><span class=n>specs</span><span class=p>,</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>                <span class=p>)</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>                <span class=n>parsed_requirements</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>parse_result</span><span class=p>)</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>        <span class=s2>&quot;Completed parsing: </span><span class=si>%d</span><span class=s2> requirement(s)&quot;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>parsed_requirements</span><span class=p>)</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>    <span class=p>)</span>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>    <span class=k>return</span> <span class=n>parsed_requirements</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.RequirementsParser.parse_line class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">parse_line</span> <a href=#depkeeper.core.RequirementsParser.parse_line class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>parse_line</span><span class=p>(</span><span class=n>line_text</span><span class=p>:</span> <span class=n><span title=str>str</span></span><span class=p>,</span> <span class=n>line_number</span><span class=p>:</span> <span class=n><span title=int>int</span></span><span class=p>,</span> <span class=n>source_file_path</span><span class=p>:</span> <span class=n><span title=typing.Optional>Optional</span></span><span class=p>[</span><span class=n><span title=str>str</span></span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=n>_current_directory_path</span><span class=p>:</span> <span class=n><span title=typing.Optional>Optional</span></span><span class=p>[</span><span class=n><span title=pathlib.Path>Path</span></span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=typing.Optional>Optional</span></span><span class=p>[</span><span class=n><span title=typing.Union>Union</span></span><span class=p>[</span><span class=n><span title=depkeeper.models.requirement.Requirement>Requirement</span></span><span class=p>,</span> <span class=n><span title=typing.List>List</span></span><span class=p>[</span><span class=n><span title=depkeeper.models.requirement.Requirement>Requirement</span></span><span class=p>]]]</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Parse a single line from a requirements file.</p> <p>Handles all pip-supported line types:</p> <ul> <li>Blank lines and <code>#</code> comments  <code>None</code></li> <li><code>-r file.txt</code>  <code>List[Requirement]</code> (nested parse)</li> <li><code>-c file.txt</code>  <code>None</code> (side-effect: populates constraints)</li> <li><code>-e &lt;url-or-path&gt;</code>  editable :class:<code>Requirement</code></li> <li><code>pkg==1.0 --hash sha256:...</code>  :class:<code>Requirement</code> with hashes</li> <li>Standard <abbr title="Python Enhancement Proposal">PEP</abbr> 508 specs  :class:<code>Requirement</code></li> </ul> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>line_text</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Raw line text (may include leading/trailing whitespace).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=str>str</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>line_number</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Line number (1-indexed) for error reporting.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=int>int</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>source_file_path</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Optional source file path for error messages.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=typing.Optional>Optional</span>[<span title=str>str</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>_current_directory_path</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Internal; directory of the file being parsed (used to resolve relative <code>-r</code> / <code>-c</code> paths).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=typing.Optional>Optional</span>[<span title=pathlib.Path>Path</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.Optional>Optional</span>[<span title=typing.Union>Union</span>[<span title=depkeeper.models.requirement.Requirement>Requirement</span>, <span title=typing.List>List</span>[<span title=depkeeper.models.requirement.Requirement>Requirement</span>]]]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <ul> <li><code>None</code> for comments, blank lines, or <code>-c</code> directives.</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.Optional>Optional</span>[<span title=typing.Union>Union</span>[<span title=depkeeper.models.requirement.Requirement>Requirement</span>, <span title=typing.List>List</span>[<span title=depkeeper.models.requirement.Requirement>Requirement</span>]]]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <ul> <li><code>List[Requirement]</code> when the line is a <code>-r</code> include.</li> </ul> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.Optional>Optional</span>[<span title=typing.Union>Union</span>[<span title=depkeeper.models.requirement.Requirement>Requirement</span>, <span title=typing.List>List</span>[<span title=depkeeper.models.requirement.Requirement>Requirement</span>]]]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <ul> <li><code>Requirement</code> for all other valid package specs.</li> </ul> </div> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><span title=depkeeper.exceptions.ParseError>ParseError</span></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>The line contains invalid syntax or a directive that cannot be processed.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; parser = RequirementsParser()
&gt;&gt;&gt; parser.parse_line(&quot;requests&gt;=2.25.0&quot;, 1)
&lt;Requirement requests&gt;=2.25.0&gt;
&gt;&gt;&gt; parser.parse_line(&quot;# comment&quot;, 2) is None
True
&gt;&gt;&gt; parser.parse_line(&quot;-r base.txt&quot;, 3)  # returns List[Requirement]
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/parser.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span>
<span class=normal><a href=#__codelineno-0-313>313</a></span>
<span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><span class=k>def</span><span class=w> </span><span class=nf>parse_line</span><span class=p>(</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>    <span class=n>line_text</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>    <span class=n>line_number</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>    <span class=n>source_file_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>    <span class=n>_current_directory_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Path</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Requirement</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Requirement</span><span class=p>]]]:</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Parse a single line from a requirements file.</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a><span class=sd>    Handles all pip-supported line types:</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><span class=sd>    - Blank lines and ``#`` comments  ``None``</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><span class=sd>    - ``-r file.txt``  ``List[Requirement]`` (nested parse)</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><span class=sd>    - ``-c file.txt``  ``None`` (side-effect: populates constraints)</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><span class=sd>    - ``-e &lt;url-or-path&gt;``  editable :class:`Requirement`</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a><span class=sd>    - ``pkg==1.0 --hash sha256:...``  :class:`Requirement` with hashes</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a><span class=sd>    - Standard PEP 508 specs  :class:`Requirement`</span>
</span><span id=__span-0-313><a id=__codelineno-0-313 name=__codelineno-0-313></a>
</span><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><span class=sd>    Args:</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><span class=sd>        line_text: Raw line text (may include leading/trailing whitespace).</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><span class=sd>        line_number: Line number (1-indexed) for error reporting.</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><span class=sd>        source_file_path: Optional source file path for error messages.</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><span class=sd>        _current_directory_path: Internal; directory of the file being</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><span class=sd>            parsed (used to resolve relative ``-r`` / ``-c`` paths).</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><span class=sd>    Returns:</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><span class=sd>        - ``None`` for comments, blank lines, or ``-c`` directives.</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><span class=sd>        - ``List[Requirement]`` when the line is a ``-r`` include.</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><span class=sd>        - ``Requirement`` for all other valid package specs.</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><span class=sd>    Raises:</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><span class=sd>        ParseError: The line contains invalid syntax or a directive</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><span class=sd>            that cannot be processed.</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><span class=sd>    Example::</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><span class=sd>        &gt;&gt;&gt; parser = RequirementsParser()</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=sd>        &gt;&gt;&gt; parser.parse_line(&quot;requests&gt;=2.25.0&quot;, 1)</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>        &lt;Requirement requests&gt;=2.25.0&gt;</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><span class=sd>        &gt;&gt;&gt; parser.parse_line(&quot;# comment&quot;, 2) is None</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><span class=sd>        True</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=sd>        &gt;&gt;&gt; parser.parse_line(&quot;-r base.txt&quot;, 3)  # returns List[Requirement]</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>    <span class=n>stripped_line</span> <span class=o>=</span> <span class=n>line_text</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a>    <span class=c1># Blank lines and pure comments are skipped</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>stripped_line</span> <span class=ow>or</span> <span class=n>stripped_line</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;#&quot;</span><span class=p>):</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a>        <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>    <span class=c1># Extract inline comment (everything after a non-URL &#39;#&#39;)</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>    <span class=n>requirement_spec</span><span class=p>,</span> <span class=n>inline_comment</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_extract_inline_comment</span><span class=p>(</span><span class=n>stripped_line</span><span class=p>)</span>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>    <span class=c1>#  Handle -r / --requirement (include another file) </span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>    <span class=k>if</span> <span class=n>requirement_spec</span><span class=o>.</span><span class=n>startswith</span><span class=p>((</span><span class=n>INCLUDE_DIRECTIVE</span><span class=p>,</span> <span class=n>INCLUDE_DIRECTIVE_LONG</span><span class=p>)):</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_include_directive</span><span class=p>(</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>            <span class=n>requirement_spec</span><span class=p>,</span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>            <span class=n>line_number</span><span class=p>,</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>            <span class=n>source_file_path</span><span class=p>,</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>            <span class=n>_current_directory_path</span><span class=p>,</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>        <span class=p>)</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>    <span class=c1>#  Handle -c / --constraint (load constraints) </span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>    <span class=k>if</span> <span class=n>requirement_spec</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>        <span class=p>(</span><span class=n>CONSTRAINT_DIRECTIVE</span><span class=p>,</span> <span class=n>CONSTRAINT_DIRECTIVE_LONG</span><span class=p>)</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>    <span class=p>):</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_handle_constraint_directive</span><span class=p>(</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>            <span class=n>requirement_spec</span><span class=p>,</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>            <span class=n>line_number</span><span class=p>,</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>            <span class=n>source_file_path</span><span class=p>,</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>            <span class=n>_current_directory_path</span><span class=p>,</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>        <span class=p>)</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>        <span class=k>return</span> <span class=kc>None</span>  <span class=c1># constraints are stored, not returned</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>    <span class=c1># Strip quotes that may wrap the entire spec</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>    <span class=n>requirement_spec</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_remove_surrounding_quotes</span><span class=p>(</span><span class=n>requirement_spec</span><span class=p>)</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>    <span class=c1>#  Check for -e / --editable flag </span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>    <span class=n>is_editable</span> <span class=o>=</span> <span class=n>requirement_spec</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>        <span class=p>(</span><span class=n>EDITABLE_DIRECTIVE</span><span class=p>,</span> <span class=n>EDITABLE_DIRECTIVE_LONG</span><span class=p>)</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>    <span class=p>)</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>    <span class=k>if</span> <span class=n>is_editable</span><span class=p>:</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a>        <span class=c1># Extract everything after &quot;-e &quot; or &quot;--editable &quot;</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a>        <span class=n>requirement_spec</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>            <span class=n>requirement_spec</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span> <span class=k>if</span> <span class=s2>&quot; &quot;</span> <span class=ow>in</span> <span class=n>requirement_spec</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>        <span class=p>)</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>    <span class=c1>#  Extract --hash directives </span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>    <span class=n>hash_values</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s2>&quot;--hash[=\s]+(\S+)&quot;</span><span class=p>,</span> <span class=n>requirement_spec</span><span class=p>)</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>    <span class=k>if</span> <span class=n>hash_values</span><span class=p>:</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>        <span class=c1># Remove all --hash tokens from the spec</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>        <span class=n>requirement_spec</span> <span class=o>=</span> <span class=s2>&quot; &quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>            <span class=n>token</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>            <span class=k>for</span> <span class=n>token</span> <span class=ow>in</span> <span class=n>requirement_spec</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>token</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=n>HASH_DIRECTIVE</span><span class=p>)</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>        <span class=p>)</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>    <span class=c1>#  Dispatch to appropriate builder </span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>    <span class=n>url_components</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_parse_direct_url</span><span class=p>(</span><span class=n>requirement_spec</span><span class=p>)</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>    <span class=k>if</span> <span class=n>url_components</span><span class=p>:</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>        <span class=n>parsed_requirement</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_build_url_based_requirement</span><span class=p>(</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>            <span class=n>url_string</span><span class=o>=</span><span class=n>requirement_spec</span><span class=p>,</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a>            <span class=n>url_components</span><span class=o>=</span><span class=n>url_components</span><span class=p>,</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a>            <span class=n>is_editable</span><span class=o>=</span><span class=n>is_editable</span><span class=p>,</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a>            <span class=n>hash_values</span><span class=o>=</span><span class=n>hash_values</span><span class=p>,</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a>            <span class=n>inline_comment</span><span class=o>=</span><span class=n>inline_comment</span><span class=p>,</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a>            <span class=n>original_line</span><span class=o>=</span><span class=n>line_text</span><span class=p>,</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a>            <span class=n>line_number</span><span class=o>=</span><span class=n>line_number</span><span class=p>,</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a>        <span class=p>)</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a>    <span class=k>elif</span> <span class=n>local_path_components</span> <span class=o>:=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_parse_local_file_path</span><span class=p>(</span><span class=n>requirement_spec</span><span class=p>):</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a>        <span class=n>parsed_requirement</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_build_local_path_requirement</span><span class=p>(</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a>            <span class=n>path_components</span><span class=o>=</span><span class=n>local_path_components</span><span class=p>,</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a>            <span class=n>current_directory</span><span class=o>=</span><span class=n>_current_directory_path</span><span class=p>,</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>            <span class=n>is_editable</span><span class=o>=</span><span class=n>is_editable</span><span class=p>,</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>            <span class=n>hash_values</span><span class=o>=</span><span class=n>hash_values</span><span class=p>,</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a>            <span class=n>inline_comment</span><span class=o>=</span><span class=n>inline_comment</span><span class=p>,</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>            <span class=n>original_line</span><span class=o>=</span><span class=n>line_text</span><span class=p>,</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>            <span class=n>line_number</span><span class=o>=</span><span class=n>line_number</span><span class=p>,</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>        <span class=p>)</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>        <span class=c1># Standard PEP 508 package specifier</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>        <span class=n>parsed_requirement</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_build_standard_pep508_requirement</span><span class=p>(</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>            <span class=n>requirement_spec</span><span class=o>=</span><span class=n>requirement_spec</span><span class=p>,</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>            <span class=n>is_editable</span><span class=o>=</span><span class=n>is_editable</span><span class=p>,</span>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>            <span class=n>hash_values</span><span class=o>=</span><span class=n>hash_values</span><span class=p>,</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>            <span class=n>inline_comment</span><span class=o>=</span><span class=n>inline_comment</span><span class=p>,</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>            <span class=n>original_line</span><span class=o>=</span><span class=n>line_text</span><span class=p>,</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a>            <span class=n>line_number</span><span class=o>=</span><span class=n>line_number</span><span class=p>,</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a>            <span class=n>source_file_path</span><span class=o>=</span><span class=n>source_file_path</span><span class=p>,</span>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a>        <span class=p>)</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>    <span class=c1># Apply any constraint loaded via -c directive</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_constraint_to_requirement</span><span class=p>(</span><span class=n>parsed_requirement</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.RequirementsParser.get_constraints class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_constraints</span> <a href=#depkeeper.core.RequirementsParser.get_constraints class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>get_constraints</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=n><span title=typing.Dict>Dict</span></span><span class=p>[</span><span class=n><span title=str>str</span></span><span class=p>,</span> <span class=n><span title=depkeeper.models.requirement.Requirement>Requirement</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Return a copy of all constraint requirements loaded via <code>-c</code>.</p> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=depkeeper.models.requirement.Requirement>Requirement</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Dictionary mapping normalised package names to their constraint</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=depkeeper.models.requirement.Requirement>Requirement</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>class:<code>Requirement</code> objects.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; parser = RequirementsParser()
&gt;&gt;&gt; parser.parse_file(&quot;requirements.txt&quot;)  # includes -c constraints.txt
&gt;&gt;&gt; constraints = parser.get_constraints()
&gt;&gt;&gt; constraints.get(&quot;django&quot;)
&lt;Requirement django==3.2&gt;
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/parser.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a><span class=k>def</span><span class=w> </span><span class=nf>get_constraints</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Requirement</span><span class=p>]:</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return a copy of all constraint requirements loaded via ``-c``.</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><span class=sd>    Returns:</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a><span class=sd>        Dictionary mapping normalised package names to their constraint</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a><span class=sd>        :class:`Requirement` objects.</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a><span class=sd>    Example::</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a><span class=sd>        &gt;&gt;&gt; parser = RequirementsParser()</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a><span class=sd>        &gt;&gt;&gt; parser.parse_file(&quot;requirements.txt&quot;)  # includes -c constraints.txt</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a><span class=sd>        &gt;&gt;&gt; constraints = parser.get_constraints()</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a><span class=sd>        &gt;&gt;&gt; constraints.get(&quot;django&quot;)</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a><span class=sd>        &lt;Requirement django==3.2&gt;</span>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_constraint_requirements</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.RequirementsParser.reset class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">reset</span> <a href=#depkeeper.core.RequirementsParser.reset class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>reset</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Clear all internal state (include stack and constraints).</p> <p>Call this before reusing the parser on a new, unrelated set of files to prevent cross-contamination.</p> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; parser = RequirementsParser()
&gt;&gt;&gt; parser.parse_file(&quot;projectA/requirements.txt&quot;)
&gt;&gt;&gt; parser.reset()
&gt;&gt;&gt; parser.parse_file(&quot;projectB/requirements.txt&quot;)  # clean slate
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/parser.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a><span class=k>def</span><span class=w> </span><span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Clear all internal state (include stack and constraints).</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a><span class=sd>    Call this before reusing the parser on a new, unrelated set of</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><span class=sd>    files to prevent cross-contamination.</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a><span class=sd>    Example::</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><span class=sd>        &gt;&gt;&gt; parser = RequirementsParser()</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><span class=sd>        &gt;&gt;&gt; parser.parse_file(&quot;projectA/requirements.txt&quot;)</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a><span class=sd>        &gt;&gt;&gt; parser.reset()</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><span class=sd>        &gt;&gt;&gt; parser.parse_file(&quot;projectB/requirements.txt&quot;)  # clean slate</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_included_files_stack</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_constraint_requirements</span> <span class=o>=</span> <span class=p>{}</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div><hr> <h3 id=versionchecker>VersionChecker<a class=headerlink href=#versionchecker title="Link to this section">&para;</a></h3> <p>Async package version checker with strict major version boundary enforcement. Recommendations never cross major version boundaries -- if the current version is <code>2.x.x</code>, the recommended version will always be <code>2.y.z</code>, never <code>3.0.0</code>.</p> <p>All network I/O is delegated to <code>PyPIDataStore</code>, which guarantees that each unique package is fetched at most once.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.core</span><span class=w> </span><span class=kn>import</span> <span class=n>VersionChecker</span><span class=p>,</span> <span class=n>PyPIDataStore</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>HTTPClient</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>main</span><span class=p>():</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>    <span class=k>async</span> <span class=k>with</span> <span class=n>HTTPClient</span><span class=p>()</span> <span class=k>as</span> <span class=n>http</span><span class=p>:</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>        <span class=n>store</span> <span class=o>=</span> <span class=n>PyPIDataStore</span><span class=p>(</span><span class=n>http</span><span class=p>)</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>        <span class=n>checker</span> <span class=o>=</span> <span class=n>VersionChecker</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=n>store</span><span class=p>)</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>        <span class=c1># Check single package</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>        <span class=n>pkg</span> <span class=o>=</span> <span class=k>await</span> <span class=n>checker</span><span class=o>.</span><span class=n>get_package_info</span><span class=p>(</span><span class=s2>&quot;requests&quot;</span><span class=p>,</span> <span class=n>current_version</span><span class=o>=</span><span class=s2>&quot;2.28.0&quot;</span><span class=p>)</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Latest: </span><span class=si>{</span><span class=n>pkg</span><span class=o>.</span><span class=n>latest_version</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Recommended: </span><span class=si>{</span><span class=n>pkg</span><span class=o>.</span><span class=n>recommended_version</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>        <span class=c1># Check multiple packages concurrently</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>        <span class=n>packages</span> <span class=o>=</span> <span class=k>await</span> <span class=n>checker</span><span class=o>.</span><span class=n>check_packages</span><span class=p>(</span><span class=n>requirements</span><span class=p>)</span>
</span></code></pre></div> <h4 id=constructor-parameters>Constructor Parameters<a class=headerlink href=#constructor-parameters title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>data_store</code></td> <td><code>PyPIDataStore</code></td> <td>Required</td> <td>Shared <abbr title="Python Package Index">PyPI</abbr> metadata cache</td> </tr> <tr> <td><code>infer_version_from_constraints</code></td> <td><code>bool</code></td> <td><code>True</code></td> <td>Infer current version from range constraints like <code>&gt;=2.0</code></td> </tr> </tbody> </table> <h4 id=methods_1>Methods<a class=headerlink href=#methods_1 title="Link to this section">&para;</a></h4> <div class="doc doc-object doc-class"> <a id=depkeeper.core.VersionChecker></a> <div class="doc doc-contents first"> <p>Async package version checker with strict major version boundaries.</p> <p>Fetches metadata from <abbr title="Python Package Index">PyPI</abbr> (via the shared data store) and determines the highest Python-compatible version for each package, <strong>strictly respecting major-version boundaries</strong> when a current version is known. Unlike the base implementation, this checker will never recommend crossing a major version boundary, even if a newer major exists.</p> <p>All network I/O is delegated to <em>data_store</em>, which guarantees that each unique package is fetched at most once.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data_store</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Shared <abbr title="Python Package Index">PyPI</abbr> metadata cache. <strong>Required</strong>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-internal" title="<code>depkeeper.core.data_store.PyPIDataStore</code>" href=#depkeeper.core.PyPIDataStore>PyPIDataStore</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>infer_version_from_constraints</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>When <code>True</code> and a requirement has no pinned version (<code>==</code>), attempt to infer a "current" version from range constraints like <code>&gt;=2.0</code>. Defaults to <code>True</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=bool>bool</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><span title=TypeError>TypeError</span></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>If <em>data_store</em> is <code>None</code>.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; async with HTTPClient() as http:
...     store   = PyPIDataStore(http)
...     checker = VersionChecker(data_store=store)
...     pkg     = await checker.get_package_info(&quot;flask&quot;, current_version=&quot;2.0.0&quot;)
...     print(pkg.recommended_version)
&#39;2.3.3&#39;  # Never 3.x.x, even if 3.0.0 is available
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/checker.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-87>87</a></span>
<span class=normal><a href=#__codelineno-0-88>88</a></span>
<span class=normal><a href=#__codelineno-0-89>89</a></span>
<span class=normal><a href=#__codelineno-0-90>90</a></span>
<span class=normal><a href=#__codelineno-0-91>91</a></span>
<span class=normal><a href=#__codelineno-0-92>92</a></span>
<span class=normal><a href=#__codelineno-0-93>93</a></span>
<span class=normal><a href=#__codelineno-0-94>94</a></span>
<span class=normal><a href=#__codelineno-0-95>95</a></span>
<span class=normal><a href=#__codelineno-0-96>96</a></span>
<span class=normal><a href=#__codelineno-0-97>97</a></span>
<span class=normal><a href=#__codelineno-0-98>98</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>PyPIDataStore</span><span class=p>,</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a>    <span class=n>infer_version_from_constraints</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>    <span class=k>if</span> <span class=n>data_store</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>            <span class=s2>&quot;data_store must not be None; pass a PyPIDataStore instance&quot;</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>        <span class=p>)</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>:</span> <span class=n>PyPIDataStore</span> <span class=o>=</span> <span class=n>data_store</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>    <span class=bp>self</span><span class=o>.</span><span class=n>infer_version_from_constraints</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>infer_version_from_constraints</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <h2 id=depkeeper.core.VersionChecker-functions>Functions<a href=#depkeeper.core.VersionChecker-functions class=headerlink title="Link to this section">&para;</a></h2> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.VersionChecker.get_package_info class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_package_info</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> <a href=#depkeeper.core.VersionChecker.get_package_info class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>get_package_info</span><span class=p>(</span><span class=n>name</span><span class=p>:</span> <span class=n><span title=str>str</span></span><span class=p>,</span> <span class=n>current_version</span><span class=p>:</span> <span class=n><span title=typing.Optional>Optional</span></span><span class=p>[</span><span class=n><span title=str>str</span></span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=depkeeper.models.package.Package>Package</span></span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Fetch metadata and compute a recommended version for <em>name</em>.</p> <p><strong>CRITICAL</strong>: Recommendations <strong>NEVER</strong> cross major version boundaries. If <em>current_version</em> is <code>2.x.x</code>, the recommended version will be <code>2.y.z</code> (never <code>3.0.0</code>), even if <code>3.0.0</code> is the latest available version on <abbr title="Python Package Index">PyPI</abbr>.</p> <p>Calls :meth:<code>PyPIDataStore.get_package_data</code> (which may trigger a network fetch or return cached data), then applies the strict major-boundary recommendation algorithm to choose the best upgrade target.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>name</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Package name (any casing / separator style).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=str>str</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>current_version</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The version currently installed (if known). When provided, the recommendation stays within the same major version. If no compatible version exists in that major, stays on current version rather than crossing the boundary.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=typing.Optional>Optional</span>[<span title=str>str</span>]</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>A</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>class:<code>Package</code> with <code>latest_version</code>,</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><span title=depkeeper.models.package.Package>Package</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=depkeeper.models.package.Package>Package</span></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p><code>recommended_version</code>, and metadata fields populated.</p> </div> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><span title=depkeeper.exceptions.PyPIError>PyPIError</span></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>The package does not exist on <abbr title="Python Package Index">PyPI</abbr> or the <abbr title="Application Programming Interface">API</abbr> returned an unexpected status.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; pkg = await checker.get_package_info(&quot;requests&quot;, current_version=&quot;2.25.0&quot;)
&gt;&gt;&gt; pkg.latest_version
&#39;2.31.0&#39;
&gt;&gt;&gt; pkg.recommended_version
&#39;2.31.0&#39;  # Stays in major version 2
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/checker.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span>
<span class=normal><a href=#__codelineno-0-115>115</a></span>
<span class=normal><a href=#__codelineno-0-116>116</a></span>
<span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span>
<span class=normal><a href=#__codelineno-0-140>140</a></span>
<span class=normal><a href=#__codelineno-0-141>141</a></span>
<span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>get_package_info</span><span class=p>(</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a>    <span class=n>current_version</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Package</span><span class=p>:</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Fetch metadata and compute a recommended version for *name*.</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><span class=sd>    **CRITICAL**: Recommendations **NEVER** cross major version boundaries.</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><span class=sd>    If *current_version* is ``2.x.x``, the recommended version will be</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><span class=sd>    ``2.y.z`` (never ``3.0.0``), even if ``3.0.0`` is the latest available</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><span class=sd>    version on PyPI.</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><span class=sd>    Calls :meth:`PyPIDataStore.get_package_data` (which may trigger a</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=sd>    network fetch or return cached data), then applies the strict</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><span class=sd>    major-boundary recommendation algorithm to choose the best upgrade</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=sd>    target.</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>    Args:</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>        name: Package name (any casing / separator style).</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>        current_version: The version currently installed (if known).</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=sd>            When provided, the recommendation stays within the same</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>            major version. If no compatible version exists in that</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>            major, stays on current version rather than crossing</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>            the boundary.</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><span class=sd>    Returns:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><span class=sd>        A :class:`Package` with ``latest_version``,</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><span class=sd>        ``recommended_version``, and metadata fields populated.</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><span class=sd>    Raises:</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><span class=sd>        PyPIError: The package does not exist on PyPI or the API</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><span class=sd>            returned an unexpected status.</span>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><span class=sd>    Example::</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><span class=sd>        &gt;&gt;&gt; pkg = await checker.get_package_info(&quot;requests&quot;, current_version=&quot;2.25.0&quot;)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><span class=sd>        &gt;&gt;&gt; pkg.latest_version</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><span class=sd>        &#39;2.31.0&#39;</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=sd>        &gt;&gt;&gt; pkg.recommended_version</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><span class=sd>        &#39;2.31.0&#39;  # Stays in major version 2</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>        <span class=n>pkg_data</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>get_package_data</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>    <span class=k>except</span> <span class=n>PyPIError</span><span class=p>:</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a>        <span class=c1># Package not found or API error  return unavailable stub</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;Package &#39;</span><span class=si>%s</span><span class=s2>&#39; unavailable; creating stub&quot;</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>create_unavailable_package</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>current_version</span><span class=p>)</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_build_package_from_data</span><span class=p>(</span><span class=n>pkg_data</span><span class=p>,</span> <span class=n>current_version</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.VersionChecker.check_packages class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">check_packages</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> <a href=#depkeeper.core.VersionChecker.check_packages class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>check_packages</span><span class=p>(</span><span class=n>requirements</span><span class=p>:</span> <span class=n><span title=typing.List>List</span></span><span class=p>[</span><span class=n><span title=depkeeper.models.requirement.Requirement>Requirement</span></span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n><span title=typing.List>List</span></span><span class=p>[</span><span class=n><span title=depkeeper.models.package.Package>Package</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Check multiple packages concurrently.</p> <p>For each requirement, extracts the current version (via :meth:<code>extract_current_version</code>) and calls :meth:<code>get_package_info</code>. Errors for individual packages are caught and replaced with unavailable stubs so that one bad package does not block the rest.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>requirements</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Parsed requirements from a requirements file.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=typing.List>List</span>[<span title=depkeeper.models.requirement.Requirement>Requirement</span>]</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.List>List</span>[<span title=depkeeper.models.package.Package>Package</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>List of :class:<code>Package</code> objects, one per requirement.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; requirements = parser.parse_file(&quot;requirements.txt&quot;)
&gt;&gt;&gt; packages = await checker.check_packages(requirements)
&gt;&gt;&gt; [p.name for p in packages if p.recommended_version]
[&#39;flask&#39;, &#39;requests&#39;, &#39;click&#39;]
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/checker.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>check_packages</span><span class=p>(</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a>    <span class=n>requirements</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Requirement</span><span class=p>],</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Package</span><span class=p>]:</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Check multiple packages concurrently.</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>    For each requirement, extracts the current version (via</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>    :meth:`extract_current_version`) and calls :meth:`get_package_info`.</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>    Errors for individual packages are caught and replaced with</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>    unavailable stubs so that one bad package does not block the rest.</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>    Args:</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>        requirements: Parsed requirements from a requirements file.</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><span class=sd>    Returns:</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><span class=sd>        List of :class:`Package` objects, one per requirement.</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=sd>    Example::</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><span class=sd>        &gt;&gt;&gt; requirements = parser.parse_file(&quot;requirements.txt&quot;)</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><span class=sd>        &gt;&gt;&gt; packages = await checker.check_packages(requirements)</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><span class=sd>        &gt;&gt;&gt; [p.name for p in packages if p.recommended_version]</span>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a><span class=sd>        [&#39;flask&#39;, &#39;requests&#39;, &#39;click&#39;]</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>    <span class=n>tasks</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>_create_package_check_task</span><span class=p>(</span><span class=n>req</span><span class=p>)</span> <span class=k>for</span> <span class=n>req</span> <span class=ow>in</span> <span class=n>requirements</span><span class=p>]</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>    <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=o>*</span><span class=n>tasks</span><span class=p>,</span> <span class=n>return_exceptions</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_process_check_results</span><span class=p>(</span><span class=n>requirements</span><span class=p>,</span> <span class=n>results</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.VersionChecker.extract_current_version class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">extract_current_version</span> <a href=#depkeeper.core.VersionChecker.extract_current_version class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>extract_current_version</span><span class=p>(</span><span class=n>req</span><span class=p>:</span> <span class=n><span title=depkeeper.models.requirement.Requirement>Requirement</span></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=typing.Optional>Optional</span></span><span class=p>[</span><span class=n><span title=str>str</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Infer a "current" version from a requirement's version specifiers.</p> <p>Heuristic:</p> <ol> <li>If the requirement has exactly one specifier and it is <code>==</code>, return that version (pinned).</li> <li>If :attr:<code>infer_version_from_constraints</code> is <code>False</code>, stop here.</li> <li>Otherwise, scan for the first <code>&gt;=</code>, <code>&gt;</code>, or <code>~=</code> specifier and return its version. This treats <code>&gt;=2.0</code> as "currently on 2.0" for major-version boundary purposes.</li> </ol> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>req</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>A parsed :class:<code>Requirement</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=depkeeper.models.requirement.Requirement>Requirement</span></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.Optional>Optional</span>[<span title=str>str</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The inferred version string, or <code>None</code> when inference is not</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.Optional>Optional</span>[<span title=str>str</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>possible.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; req1 = Requirement(name=&quot;flask&quot;, specs=[(&quot;==&quot;, &quot;2.0.0&quot;)], ...)
&gt;&gt;&gt; checker.extract_current_version(req1)
&#39;2.0.0&#39;

&gt;&gt;&gt; req2 = Requirement(name=&quot;flask&quot;, specs=[(&quot;&gt;=&quot;, &quot;2.0&quot;), (&quot;&lt;&quot;, &quot;3&quot;)], ...)
&gt;&gt;&gt; checker.extract_current_version(req2)
&#39;2.0&#39;

&gt;&gt;&gt; req3 = Requirement(name=&quot;flask&quot;, specs=[], ...)
&gt;&gt;&gt; checker.extract_current_version(req3) is None
True
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/checker.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span>
<span class=normal><a href=#__codelineno-0-186>186</a></span>
<span class=normal><a href=#__codelineno-0-187>187</a></span>
<span class=normal><a href=#__codelineno-0-188>188</a></span>
<span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a><span class=k>def</span><span class=w> </span><span class=nf>extract_current_version</span><span class=p>(</span>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-184><a id=__codelineno-0-184 name=__codelineno-0-184></a>    <span class=n>req</span><span class=p>:</span> <span class=n>Requirement</span><span class=p>,</span>
</span><span id=__span-0-185><a id=__codelineno-0-185 name=__codelineno-0-185></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-186><a id=__codelineno-0-186 name=__codelineno-0-186></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Infer a &quot;current&quot; version from a requirement&#39;s version specifiers.</span>
</span><span id=__span-0-187><a id=__codelineno-0-187 name=__codelineno-0-187></a>
</span><span id=__span-0-188><a id=__codelineno-0-188 name=__codelineno-0-188></a><span class=sd>    Heuristic:</span>
</span><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a><span class=sd>    1. If the requirement has exactly one specifier and it is ``==``,</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><span class=sd>       return that version (pinned).</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><span class=sd>    2. If :attr:`infer_version_from_constraints` is ``False``, stop here.</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><span class=sd>    3. Otherwise, scan for the first ``&gt;=``, ``&gt;``, or ``~=`` specifier</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><span class=sd>       and return its version. This treats ``&gt;=2.0`` as &quot;currently on</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a><span class=sd>       2.0&quot; for major-version boundary purposes.</span>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><span class=sd>    Args:</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=sd>        req: A parsed :class:`Requirement`.</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=sd>    Returns:</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=sd>        The inferred version string, or ``None`` when inference is not</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><span class=sd>        possible.</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=sd>    Example::</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a><span class=sd>        &gt;&gt;&gt; req1 = Requirement(name=&quot;flask&quot;, specs=[(&quot;==&quot;, &quot;2.0.0&quot;)], ...)</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a><span class=sd>        &gt;&gt;&gt; checker.extract_current_version(req1)</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a><span class=sd>        &#39;2.0.0&#39;</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a><span class=sd>        &gt;&gt;&gt; req2 = Requirement(name=&quot;flask&quot;, specs=[(&quot;&gt;=&quot;, &quot;2.0&quot;), (&quot;&lt;&quot;, &quot;3&quot;)], ...)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a><span class=sd>        &gt;&gt;&gt; checker.extract_current_version(req2)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a><span class=sd>        &#39;2.0&#39;</span>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a><span class=sd>        &gt;&gt;&gt; req3 = Requirement(name=&quot;flask&quot;, specs=[], ...)</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a><span class=sd>        &gt;&gt;&gt; checker.extract_current_version(req3) is None</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a><span class=sd>        True</span>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>req</span><span class=o>.</span><span class=n>specs</span><span class=p>:</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>        <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>    <span class=c1># Exact pin: treat as the current version</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>req</span><span class=o>.</span><span class=n>specs</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>req</span><span class=o>.</span><span class=n>specs</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&quot;==&quot;</span><span class=p>:</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>        <span class=k>return</span> <span class=n>req</span><span class=o>.</span><span class=n>specs</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>infer_version_from_constraints</span><span class=p>:</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>        <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>    <span class=c1># Infer from range lower-bound operators</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>    <span class=k>for</span> <span class=n>operator</span><span class=p>,</span> <span class=n>version</span> <span class=ow>in</span> <span class=n>req</span><span class=o>.</span><span class=n>specs</span><span class=p>:</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>        <span class=k>if</span> <span class=n>operator</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;&gt;=&quot;</span><span class=p>,</span> <span class=s2>&quot;&gt;&quot;</span><span class=p>,</span> <span class=s2>&quot;~=&quot;</span><span class=p>):</span>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>            <span class=k>return</span> <span class=n>version</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>    <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div><hr> <h3 id=pypidatastore>PyPIDataStore<a class=headerlink href=#pypidatastore title="Link to this section">&para;</a></h3> <p>Async-safe, per-process cache for <abbr title="Python Package Index">PyPI</abbr> package metadata. Each unique package name triggers at most one <abbr title="Hypertext Transfer Protocol">HTTP</abbr> request to <code>/pypi/{pkg}/json</code>. A semaphore limits concurrent outbound fetches, and double-checked locking prevents duplicate requests when multiple coroutines request the same package simultaneously.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.core</span><span class=w> </span><span class=kn>import</span> <span class=n>PyPIDataStore</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>HTTPClient</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>main</span><span class=p>():</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    <span class=k>async</span> <span class=k>with</span> <span class=n>HTTPClient</span><span class=p>()</span> <span class=k>as</span> <span class=n>http</span><span class=p>:</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>        <span class=n>store</span> <span class=o>=</span> <span class=n>PyPIDataStore</span><span class=p>(</span><span class=n>http</span><span class=p>,</span> <span class=n>concurrent_limit</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>        <span class=c1># Fetch package data</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>        <span class=n>data</span> <span class=o>=</span> <span class=k>await</span> <span class=n>store</span><span class=o>.</span><span class=n>get_package_data</span><span class=p>(</span><span class=s2>&quot;requests&quot;</span><span class=p>)</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Latest: </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>latest_version</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;All versions: </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>all_versions</span><span class=p>[:</span><span class=mi>5</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>        <span class=c1># Prefetch multiple packages concurrently</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>        <span class=k>await</span> <span class=n>store</span><span class=o>.</span><span class=n>prefetch_packages</span><span class=p>([</span><span class=s2>&quot;flask&quot;</span><span class=p>,</span> <span class=s2>&quot;click&quot;</span><span class=p>,</span> <span class=s2>&quot;jinja2&quot;</span><span class=p>])</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>        <span class=c1># Get cached data (no network call)</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>        <span class=n>cached</span> <span class=o>=</span> <span class=n>store</span><span class=o>.</span><span class=n>get_cached_package</span><span class=p>(</span><span class=s2>&quot;flask&quot;</span><span class=p>)</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a>        <span class=c1># Get dependencies for a specific version</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a>        <span class=n>deps</span> <span class=o>=</span> <span class=k>await</span> <span class=n>store</span><span class=o>.</span><span class=n>get_version_dependencies</span><span class=p>(</span><span class=s2>&quot;flask&quot;</span><span class=p>,</span> <span class=s2>&quot;2.3.0&quot;</span><span class=p>)</span>
</span></code></pre></div> <h4 id=constructor-parameters_1>Constructor Parameters<a class=headerlink href=#constructor-parameters_1 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>http_client</code></td> <td><code>HTTPClient</code></td> <td>Required</td> <td>Pre-configured async <abbr title="Hypertext Transfer Protocol">HTTP</abbr> client</td> </tr> <tr> <td><code>concurrent_limit</code></td> <td><code>int</code></td> <td><code>10</code></td> <td>Maximum concurrent <abbr title="Python Package Index">PyPI</abbr> fetches</td> </tr> </tbody> </table> <h4 id=methods_2>Methods<a class=headerlink href=#methods_2 title="Link to this section">&para;</a></h4> <div class="doc doc-object doc-class"> <a id=depkeeper.core.PyPIDataStore></a> <div class="doc doc-contents first"> <p>Async-safe, per-process cache for <abbr title="Python Package Index">PyPI</abbr> package metadata.</p> <p>Each unique (normalised) package name triggers <strong>at most one</strong> <abbr title="Hypertext Transfer Protocol">HTTP</abbr> request to <code>/pypi/{pkg}/json</code>. A :class:<code>asyncio.Semaphore</code> limits concurrent outbound fetches, and a double-checked lock inside the semaphore prevents thundering-herd duplicates when several coroutines request the same package simultaneously.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>http_client</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>A pre-configured :class:<code>HTTPClient</code> instance (owns connection pool / session).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=depkeeper.utils.http.HTTPClient>HTTPClient</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>concurrent_limit</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Maximum number of <abbr title="Python Package Index">PyPI</abbr> fetches that may be in-flight at once. Defaults to <code>10</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=int>int</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>10</code> </span> </p> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>async with HTTPClient() as client:
    store = PyPIDataStore(client, concurrent_limit=5)

    # warm the cache for several packages at once
    await store.prefetch_packages([&quot;flask&quot;, &quot;click&quot;, &quot;jinja2&quot;])

    # subsequent calls return instantly from cache
    flask = await store.get_package_data(&quot;flask&quot;)
    print(flask.latest_version)
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/data_store.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span>
<span class=normal><a href=#__codelineno-0-239>239</a></span>
<span class=normal><a href=#__codelineno-0-240>240</a></span>
<span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a><span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>    <span class=n>http_client</span><span class=p>:</span> <span class=n>HTTPClient</span><span class=p>,</span>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>    <span class=n>concurrent_limit</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>10</span><span class=p>,</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-239><a id=__codelineno-0-239 name=__codelineno-0-239></a>    <span class=bp>self</span><span class=o>.</span><span class=n>http_client</span> <span class=o>=</span> <span class=n>http_client</span>
</span><span id=__span-0-240><a id=__codelineno-0-240 name=__codelineno-0-240></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_semaphore</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Semaphore</span><span class=p>(</span><span class=n>concurrent_limit</span><span class=p>)</span>
</span><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>    <span class=c1># Primary cache: normalised name  parsed package snapshot</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_package_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>PyPIPackageData</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a>    <span class=c1># Secondary cache: &quot;name==version&quot;  dependency list (avoids</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>    <span class=c1># repeated per-version fetches even after the main cache is warm)</span>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_version_deps_cache</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=p>{}</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <h2 id=depkeeper.core.PyPIDataStore-functions>Functions<a href=#depkeeper.core.PyPIDataStore-functions class=headerlink title="Link to this section">&para;</a></h2> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.PyPIDataStore.get_package_data class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_package_data</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> <a href=#depkeeper.core.PyPIDataStore.get_package_data class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>get_package_data</span><span class=p>(</span><span class=n>name</span><span class=p>:</span> <span class=n><span title=str>str</span></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=depkeeper.core.data_store.PyPIPackageData>PyPIPackageData</span></span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Fetch (or return cached) metadata for <em>name</em>.</p> <p>Uses double-checked locking: the first check is lock-free; if the package is missing a second check runs <em>inside</em> the semaphore so that only one coroutine actually performs the <abbr title="Hypertext Transfer Protocol">HTTP</abbr> call.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>name</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p><abbr title="Python Package Index">PyPI</abbr> package name (any casing / underscore style).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=str>str</span></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>A</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>class:<code>PyPIPackageData</code> populated from the latest <abbr title="Python Package Index">PyPI</abbr></p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code><span title=depkeeper.core.data_store.PyPIPackageData>PyPIPackageData</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=depkeeper.core.data_store.PyPIPackageData>PyPIPackageData</span></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p><abbr title="JavaScript Object Notation">JSON</abbr> response.</p> </div> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><span title=depkeeper.exceptions.PyPIError>PyPIError</span></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>The package does not exist on <abbr title="Python Package Index">PyPI</abbr> or the <abbr title="Application Programming Interface">API</abbr> returned an unexpected status code.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; data = await store.get_package_data(&quot;Requests&quot;)
&gt;&gt;&gt; data.name
&#39;requests&#39;
&gt;&gt;&gt; data.latest_version
&#39;2.31.0&#39;
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/data_store.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span>
<span class=normal><a href=#__codelineno-0-275>275</a></span>
<span class=normal><a href=#__codelineno-0-276>276</a></span>
<span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>get_package_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PyPIPackageData</span><span class=p>:</span>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Fetch (or return cached) metadata for *name*.</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a><span class=sd>    Uses double-checked locking: the first check is lock-free; if the</span>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a><span class=sd>    package is missing a second check runs *inside* the semaphore so</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a><span class=sd>    that only one coroutine actually performs the HTTP call.</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a><span class=sd>    Args:</span>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a><span class=sd>        name: PyPI package name (any casing / underscore style).</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a><span class=sd>    Returns:</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a><span class=sd>        A :class:`PyPIPackageData` populated from the latest PyPI</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a><span class=sd>        JSON response.</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a><span class=sd>    Raises:</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a><span class=sd>        PyPIError: The package does not exist on PyPI or the API</span>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a><span class=sd>            returned an unexpected status code.</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a><span class=sd>    Example::</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a><span class=sd>        &gt;&gt;&gt; data = await store.get_package_data(&quot;Requests&quot;)</span>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a><span class=sd>        &gt;&gt;&gt; data.name</span>
</span><span id=__span-0-275><a id=__codelineno-0-275 name=__codelineno-0-275></a><span class=sd>        &#39;requests&#39;</span>
</span><span id=__span-0-276><a id=__codelineno-0-276 name=__codelineno-0-276></a><span class=sd>        &gt;&gt;&gt; data.latest_version</span>
</span><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><span class=sd>        &#39;2.31.0&#39;</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a>    <span class=n>normalized</span> <span class=o>=</span> <span class=n>_normalize</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>    <span class=c1># Fast path  already cached (no lock needed)</span>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a>    <span class=k>if</span> <span class=n>normalized</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_package_data</span><span class=p>:</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_package_data</span><span class=p>[</span><span class=n>normalized</span><span class=p>]</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>    <span class=k>async</span> <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>_semaphore</span><span class=p>:</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>        <span class=c1># Second check  another coroutine may have populated while we waited</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>        <span class=k>if</span> <span class=n>normalized</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_package_data</span><span class=p>:</span>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_package_data</span><span class=p>[</span><span class=n>normalized</span><span class=p>]</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>        <span class=n>data</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fetch_from_pypi</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>        <span class=n>pkg_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_parse_package_data</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_package_data</span><span class=p>[</span><span class=n>normalized</span><span class=p>]</span> <span class=o>=</span> <span class=n>pkg_data</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>        <span class=k>return</span> <span class=n>pkg_data</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.PyPIDataStore.prefetch_packages class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">prefetch_packages</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> <a href=#depkeeper.core.PyPIDataStore.prefetch_packages class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>prefetch_packages</span><span class=p>(</span><span class=n>names</span><span class=p>:</span> <span class=n><span title=typing.List>List</span></span><span class=p>[</span><span class=n><span title=str>str</span></span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Concurrently warm the cache for a batch of packages.</p> <p>Errors for individual packages are silenced so that one bad package name does not prevent the rest from being cached.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>names</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Package names to prefetch.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=typing.List>List</span>[<span title=str>str</span>]</code> </span> </p> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; await store.prefetch_packages([&quot;numpy&quot;, &quot;pandas&quot;, &quot;scipy&quot;])
# subsequent get_package_data calls for these return instantly
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/data_store.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>prefetch_packages</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>names</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Concurrently warm the cache for a batch of packages.</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a><span class=sd>    Errors for individual packages are silenced so that one bad</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a><span class=sd>    package name does not prevent the rest from being cached.</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a><span class=sd>    Args:</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><span class=sd>        names: Package names to prefetch.</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a><span class=sd>    Example::</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><span class=sd>        &gt;&gt;&gt; await store.prefetch_packages([&quot;numpy&quot;, &quot;pandas&quot;, &quot;scipy&quot;])</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><span class=sd>        # subsequent get_package_data calls for these return instantly</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>    <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=o>*</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>get_package_data</span><span class=p>(</span><span class=n>name</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>names</span><span class=p>),</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>        <span class=n>return_exceptions</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># swallow per-package failures</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.PyPIDataStore.get_version_dependencies class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_version_dependencies</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> <a href=#depkeeper.core.PyPIDataStore.get_version_dependencies class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>get_version_dependencies</span><span class=p>(</span><span class=n>name</span><span class=p>:</span> <span class=n><span title=str>str</span></span><span class=p>,</span> <span class=n>version</span><span class=p>:</span> <span class=n><span title=str>str</span></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=typing.List>List</span></span><span class=p>[</span><span class=n><span title=str>str</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Return the base dependencies for a specific version of <em>name</em>.</p> <p>Resolution order (fastest first):</p> <ol> <li>Per-version dependency cache (<code>_version_deps_cache</code>).</li> <li>Already-populated fields inside the cached :class:<code>PyPIPackageData</code> (<code>latest_dependencies</code> or <code>dependencies_cache</code>).</li> <li>A targeted <code>/pypi/{name}/{version}/json</code> fetch, guarded by the semaphore and a second cache check.</li> </ol> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>name</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Package name.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=str>str</span></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>version</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Exact version string, e.g. <code>"1.2.3"</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=str>str</span></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.List>List</span>[<span title=str>str</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>List of <abbr title="Python Enhancement Proposal">PEP</abbr>-508 dependency specifiers with extras and</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.List>List</span>[<span title=str>str</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>environment markers stripped.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; deps = await store.get_version_dependencies(&quot;flask&quot;, &quot;2.3.0&quot;)
&gt;&gt;&gt; deps
[&#39;Werkzeug&gt;=2.0&#39;, &#39;Jinja2&gt;=3.0&#39;, ...]
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/data_store.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>get_version_dependencies</span><span class=p>(</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a>    <span class=n>version</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the base dependencies for a specific version of *name*.</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><span class=sd>    Resolution order (fastest first):</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a><span class=sd>    1. Per-version dependency cache (``_version_deps_cache``).</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><span class=sd>    2. Already-populated fields inside the cached</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a><span class=sd>       :class:`PyPIPackageData` (``latest_dependencies`` or</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><span class=sd>       ``dependencies_cache``).</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><span class=sd>    3. A targeted ``/pypi/{name}/{version}/json`` fetch, guarded by</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><span class=sd>       the semaphore and a second cache check.</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><span class=sd>    Args:</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><span class=sd>        name: Package name.</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><span class=sd>        version: Exact version string, e.g. ``&quot;1.2.3&quot;``.</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>    Returns:</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><span class=sd>        List of PEP-508 dependency specifiers with extras and</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a><span class=sd>        environment markers stripped.</span>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>    Example::</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>        &gt;&gt;&gt; deps = await store.get_version_dependencies(&quot;flask&quot;, &quot;2.3.0&quot;)</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>        &gt;&gt;&gt; deps</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=sd>        [&#39;Werkzeug&gt;=2.0&#39;, &#39;Jinja2&gt;=3.0&#39;, ...]</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a>    <span class=n>normalized</span> <span class=o>=</span> <span class=n>_normalize</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>    <span class=n>cache_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>normalized</span><span class=si>}</span><span class=s2>==</span><span class=si>{</span><span class=n>version</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>    <span class=c1>#  layer 1: flat version-deps cache </span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>    <span class=k>if</span> <span class=n>cache_key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_deps_cache</span><span class=p>:</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_deps_cache</span><span class=p>[</span><span class=n>cache_key</span><span class=p>]</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>    <span class=c1>#  layer 2: already inside PyPIPackageData </span>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a>    <span class=n>pkg_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_package_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>normalized</span><span class=p>)</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a>    <span class=k>if</span> <span class=n>pkg_data</span><span class=p>:</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a>        <span class=k>if</span> <span class=n>version</span> <span class=o>==</span> <span class=n>pkg_data</span><span class=o>.</span><span class=n>latest_version</span><span class=p>:</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_version_deps_cache</span><span class=p>[</span><span class=n>cache_key</span><span class=p>]</span> <span class=o>=</span> <span class=n>pkg_data</span><span class=o>.</span><span class=n>latest_dependencies</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>            <span class=k>return</span> <span class=n>pkg_data</span><span class=o>.</span><span class=n>latest_dependencies</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a>        <span class=k>if</span> <span class=n>version</span> <span class=ow>in</span> <span class=n>pkg_data</span><span class=o>.</span><span class=n>dependencies_cache</span><span class=p>:</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a>            <span class=n>deps</span> <span class=o>=</span> <span class=n>pkg_data</span><span class=o>.</span><span class=n>dependencies_cache</span><span class=p>[</span><span class=n>version</span><span class=p>]</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_version_deps_cache</span><span class=p>[</span><span class=n>cache_key</span><span class=p>]</span> <span class=o>=</span> <span class=n>deps</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>            <span class=k>return</span> <span class=n>deps</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>    <span class=c1>#  layer 3: network fetch (double-checked) </span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>    <span class=k>async</span> <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>_semaphore</span><span class=p>:</span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>        <span class=k>if</span> <span class=n>cache_key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_deps_cache</span><span class=p>:</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_version_deps_cache</span><span class=p>[</span><span class=n>cache_key</span><span class=p>]</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>        <span class=n>deps</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_fetch_version_dependencies</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>version</span><span class=p>)</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_version_deps_cache</span><span class=p>[</span><span class=n>cache_key</span><span class=p>]</span> <span class=o>=</span> <span class=n>deps</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>        <span class=c1># Back-fill the package-level cache so future reads skip this path</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>        <span class=k>if</span> <span class=n>pkg_data</span><span class=p>:</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>            <span class=n>pkg_data</span><span class=o>.</span><span class=n>dependencies_cache</span><span class=p>[</span><span class=n>version</span><span class=p>]</span> <span class=o>=</span> <span class=n>deps</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>        <span class=k>return</span> <span class=n>deps</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.PyPIDataStore.get_cached_package class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_cached_package</span> <a href=#depkeeper.core.PyPIDataStore.get_cached_package class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>get_cached_package</span><span class=p>(</span><span class=n>name</span><span class=p>:</span> <span class=n><span title=str>str</span></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=typing.Optional>Optional</span></span><span class=p>[</span><span class=n><span title=depkeeper.core.data_store.PyPIPackageData>PyPIPackageData</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Return cached data for <em>name</em> without triggering a fetch.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>name</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Package name (any casing / underscore style).</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=str>str</span></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.Optional>Optional</span>[<span title=depkeeper.core.data_store.PyPIPackageData>PyPIPackageData</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The cached :class:<code>PyPIPackageData</code>, or <code>None</code> if the</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.Optional>Optional</span>[<span title=depkeeper.core.data_store.PyPIPackageData>PyPIPackageData</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>package has not been fetched yet.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; store.get_cached_package(&quot;flask&quot;)  # after a prior fetch
PyPIPackageData(name=&#39;flask&#39;, latest_version=&#39;3.0.0&#39;, ...)
&gt;&gt;&gt; store.get_cached_package(&quot;unknown&quot;)
None
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/data_store.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a><span class=k>def</span><span class=w> </span><span class=nf>get_cached_package</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>PyPIPackageData</span><span class=p>]:</span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return cached data for *name* without triggering a fetch.</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a><span class=sd>    Args:</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a><span class=sd>        name: Package name (any casing / underscore style).</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a><span class=sd>    Returns:</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a><span class=sd>        The cached :class:`PyPIPackageData`, or ``None`` if the</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a><span class=sd>        package has not been fetched yet.</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a><span class=sd>    Example::</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a><span class=sd>        &gt;&gt;&gt; store.get_cached_package(&quot;flask&quot;)  # after a prior fetch</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a><span class=sd>        PyPIPackageData(name=&#39;flask&#39;, latest_version=&#39;3.0.0&#39;, ...)</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a><span class=sd>        &gt;&gt;&gt; store.get_cached_package(&quot;unknown&quot;)</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a><span class=sd>        None</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_package_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>_normalize</span><span class=p>(</span><span class=n>name</span><span class=p>))</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.PyPIDataStore.get_versions class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">get_versions</span> <a href=#depkeeper.core.PyPIDataStore.get_versions class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>get_versions</span><span class=p>(</span><span class=n>name</span><span class=p>:</span> <span class=n><span title=str>str</span></span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title=typing.List>List</span></span><span class=p>[</span><span class=n><span title=str>str</span></span><span class=p>]</span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Return cached stable versions for <em>name</em> (newest first).</p> <p>Returns an empty list when <em>name</em> has not been fetched yet.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>name</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Package name.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=str>str</span></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=typing.List>List</span>[<span title=str>str</span>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>List of version strings, or <code>[]</code>.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; store.get_versions(&quot;flask&quot;)
[&#39;3.0.0&#39;, &#39;2.3.3&#39;, &#39;2.3.2&#39;, ...]
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/data_store.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a><span class=k>def</span><span class=w> </span><span class=nf>get_versions</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return cached stable versions for *name* (newest first).</span>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=sd>    Returns an empty list when *name* has not been fetched yet.</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>    Args:</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>        name: Package name.</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a><span class=sd>    Returns:</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a><span class=sd>        List of version strings, or ``[]``.</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a><span class=sd>    Example::</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a><span class=sd>        &gt;&gt;&gt; store.get_versions(&quot;flask&quot;)</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a><span class=sd>        [&#39;3.0.0&#39;, &#39;2.3.3&#39;, &#39;2.3.2&#39;, ...]</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>    <span class=n>pkg</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_cached_package</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>    <span class=k>return</span> <span class=n>pkg</span><span class=o>.</span><span class=n>all_versions</span> <span class=k>if</span> <span class=n>pkg</span> <span class=k>else</span> <span class=p>[]</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div><hr> <h3 id=pypipackagedata>PyPIPackageData<a class=headerlink href=#pypipackagedata title="Link to this section">&para;</a></h3> <p>Immutable-by-convention snapshot of one <abbr title="Python Package Index">PyPI</abbr> package, populated by <code>PyPIDataStore</code>. Contains version lists, Python compatibility data, and dependency caches.</p> <h4 id=attributes>Attributes<a class=headerlink href=#attributes title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Attribute</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td><code>str</code></td> <td>Normalized package name</td> </tr> <tr> <td><code>latest_version</code></td> <td><code>Optional[str]</code></td> <td>Latest version on <abbr title="Python Package Index">PyPI</abbr></td> </tr> <tr> <td><code>latest_requires_python</code></td> <td><code>Optional[str]</code></td> <td>Python requirement for latest version</td> </tr> <tr> <td><code>latest_dependencies</code></td> <td><code>List[str]</code></td> <td>Base dependencies of latest version</td> </tr> <tr> <td><code>all_versions</code></td> <td><code>List[str]</code></td> <td>Stable versions, newest first</td> </tr> <tr> <td><code>parsed_versions</code></td> <td><code>List[Tuple[str, Version]]</code></td> <td>Parsed version objects, descending</td> </tr> <tr> <td><code>python_requirements</code></td> <td><code>Dict[str, Optional[str]]</code></td> <td>Version to <code>requires_python</code> mapping</td> </tr> <tr> <td><code>dependencies_cache</code></td> <td><code>Dict[str, List[str]]</code></td> <td>Per-version dependency lists</td> </tr> </tbody> </table> <h4 id=methods_3>Methods<a class=headerlink href=#methods_3 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Method</th> <th>Returns</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>get_versions_in_major(major)</code></td> <td><code>List[str]</code></td> <td>Stable versions sharing a given major number</td> </tr> <tr> <td><code>is_python_compatible(version, python_version)</code></td> <td><code>bool</code></td> <td>Check if a package version supports a Python version</td> </tr> <tr> <td><code>get_python_compatible_versions(python_version, major=None)</code></td> <td><code>List[str]</code></td> <td>Stable versions compatible with a Python version</td> </tr> </tbody> </table> <hr> <h3 id=dependencyanalyzer>DependencyAnalyzer<a class=headerlink href=#dependencyanalyzer title="Link to this section">&para;</a></h3> <p>Resolves dependency conflicts with strict major version boundary enforcement. The analyzer builds a dependency graph, detects version conflicts, and iteratively adjusts recommendations until a conflict-free set is found or the iteration limit is reached.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.core</span><span class=w> </span><span class=kn>import</span> <span class=n>DependencyAnalyzer</span><span class=p>,</span> <span class=n>PyPIDataStore</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>HTTPClient</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>main</span><span class=p>():</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>    <span class=k>async</span> <span class=k>with</span> <span class=n>HTTPClient</span><span class=p>()</span> <span class=k>as</span> <span class=n>http</span><span class=p>:</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>        <span class=n>store</span> <span class=o>=</span> <span class=n>PyPIDataStore</span><span class=p>(</span><span class=n>http</span><span class=p>)</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>        <span class=n>analyzer</span> <span class=o>=</span> <span class=n>DependencyAnalyzer</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=n>store</span><span class=p>)</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>        <span class=c1># Resolve conflicts</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>        <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>analyzer</span><span class=o>.</span><span class=n>resolve_and_annotate_conflicts</span><span class=p>(</span><span class=n>packages</span><span class=p>)</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>        <span class=c1># Check results</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>        <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>resolution</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>resolved_versions</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>resolution</span><span class=o>.</span><span class=n>original</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=n>resolution</span><span class=o>.</span><span class=n>resolved</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Status: </span><span class=si>{</span><span class=n>resolution</span><span class=o>.</span><span class=n>status</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>        <span class=c1># Summary</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>        <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>summary</span><span class=p>())</span>
</span></code></pre></div> <h4 id=methods_4>Methods<a class=headerlink href=#methods_4 title="Link to this section">&para;</a></h4> <div class="doc doc-object doc-class"> <a id=depkeeper.core.DependencyAnalyzer></a> <div class="doc doc-contents first"> <p>Detect and resolve version conflicts with strict major version boundaries.</p> <p>This analyzer enhances the base conflict resolution by ensuring that no package is ever upgraded or downgraded across major version boundaries during conflict resolution. This prevents breaking changes from being inadvertently introduced.</p> <p>The analyzer works exclusively through a :class:<code>PyPIDataStore</code> instance, which guarantees that every <code>/pypi/{pkg}/json</code> call is made at most once. All public entry points are <code>async</code>.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data_store</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Shared <abbr title="Python Package Index">PyPI</abbr> data store. <strong>Required</strong>  the class has no independent <abbr title="Hypertext Transfer Protocol">HTTP</abbr> path.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-internal" title="<code>depkeeper.core.data_store.PyPIDataStore</code>" href=#depkeeper.core.PyPIDataStore>PyPIDataStore</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>concurrent_limit</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Upper bound on in-flight <abbr title="Python Package Index">PyPI</abbr> fetches. Forwarded to the internal semaphore. Defaults to <code>10</code>.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=int>int</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>10</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RAISES</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-raises-annotation> <code><span title=TypeError>TypeError</span></code> </span> </td> <td class=doc-raises-details> <div class=doc-md-description> <p>If <em>data_store</em> is <code>None</code>.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; async with HTTPClient() as http:
...     store    = PyPIDataStore(http)
...     analyzer = DependencyAnalyzer(data_store=store)
...     result   = await analyzer.resolve_and_annotate_conflicts(pkgs)
...     print(result.summary())
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/dependency_analyzer.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span>
<span class=normal><a href=#__codelineno-0-304>304</a></span>
<span class=normal><a href=#__codelineno-0-305>305</a></span>
<span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span>
<span class=normal><a href=#__codelineno-0-312>312</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a><span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-304><a id=__codelineno-0-304 name=__codelineno-0-304></a>    <span class=n>data_store</span><span class=p>:</span> <span class=n>PyPIDataStore</span><span class=p>,</span>
</span><span id=__span-0-305><a id=__codelineno-0-305 name=__codelineno-0-305></a>    <span class=n>concurrent_limit</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>10</span><span class=p>,</span>
</span><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a>    <span class=k>if</span> <span class=n>data_store</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a>        <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a>            <span class=s2>&quot;data_store must not be None; pass a PyPIDataStore instance&quot;</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a>        <span class=p>)</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>    <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=p>:</span> <span class=n>PyPIDataStore</span> <span class=o>=</span> <span class=n>data_store</span>
</span><span id=__span-0-312><a id=__codelineno-0-312 name=__codelineno-0-312></a>    <span class=bp>self</span><span class=o>.</span><span class=n>_semaphore</span><span class=p>:</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Semaphore</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Semaphore</span><span class=p>(</span><span class=n>concurrent_limit</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <h2 id=depkeeper.core.DependencyAnalyzer-functions>Functions<a href=#depkeeper.core.DependencyAnalyzer-functions class=headerlink title="Link to this section">&para;</a></h2> <div class="doc doc-object doc-function"> <h3 id=depkeeper.core.DependencyAnalyzer.resolve_and_annotate_conflicts class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">resolve_and_annotate_conflicts</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-async"><code>async</code></small> </span> <a href=#depkeeper.core.DependencyAnalyzer.resolve_and_annotate_conflicts class=headerlink title="Link to this section">&para;</a></h3> <div class="language-python doc-signature highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>resolve_and_annotate_conflicts</span><span class=p>(</span><span class=n>packages</span><span class=p>:</span> <span class=n><span title=typing.List>List</span></span><span class=p>[</span><span class=n><span title=depkeeper.models.package.Package>Package</span></span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n><span title=depkeeper.core.dependency_analyzer.ResolutionResult>ResolutionResult</span></span>
</span></code></pre></div> <div class="doc doc-contents "> <p>Resolve conflicts while strictly respecting major version boundaries.</p> <p>Algorithm outline:</p> <ol> <li>Build an <em>update set</em> mapping each package name to its proposed version (<code>recommended_version</code> if available, otherwise <code>current_version</code>). Recommended versions already respect major version boundaries.</li> <li>Prefetch metadata for every package in one concurrent burst.</li> <li>Loop up to :data:<code>_MAX_RESOLUTION_ITERATIONS</code> times:</li> </ol> <p>a. Scan for cross-conflicts in the current update set. b. If none remain, stop  the set is self-consistent. c. Attempt resolution within major version boundaries only:</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>  - Try to find a compatible source version within its current major
  - If that fails, try to constrain the target within its current major
  - If both fail, revert both packages to their current versions
</code></pre></div> <p>d. Break early when no progress is made.</p> <ol> <li>Annotate each :class:<code>Package</code> with its final version and any unresolved :class:<code>Conflict</code> objects.</li> <li>Return a :class:<code>ResolutionResult</code> with complete details.</li> </ol> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>packages</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Mutable list of :class:<code>Package</code> objects. Each object is updated in place with the resolved version and conflict metadata.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=typing.List>List</span>[<span title=depkeeper.models.package.Package>Package</span>]</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=depkeeper.core.dependency_analyzer.ResolutionResult>ResolutionResult</span></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>class:<code>ResolutionResult</code> containing the final version for each</p> </div> </td> </tr> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><span title=depkeeper.core.dependency_analyzer.ResolutionResult>ResolutionResult</span></code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>package, conflict details, and resolution statistics.</p> </div> </td> </tr> </tbody> </table> <p>Example::</p> <div class="language-text highlight"><span class=filename>Text Only</span><pre><span></span><code>&gt;&gt;&gt; result = await analyzer.resolve_and_annotate_conflicts(pkgs)
&gt;&gt;&gt; print(result.summary())
&gt;&gt;&gt; for pkg_name, info in result.resolved_versions.items():
...     if info.was_changed():
...         print(f&quot;{pkg_name}: {info.original}  {info.resolved}&quot;)
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>depkeeper/core/dependency_analyzer.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Python</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span>
<span class=normal><a href=#__codelineno-0-328>328</a></span>
<span class=normal><a href=#__codelineno-0-329>329</a></span>
<span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span>
<span class=normal><a href=#__codelineno-0-336>336</a></span>
<span class=normal><a href=#__codelineno-0-337>337</a></span>
<span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span>
<span class=normal><a href=#__codelineno-0-351>351</a></span>
<span class=normal><a href=#__codelineno-0-352>352</a></span>
<span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span>
<span class=normal><a href=#__codelineno-0-364>364</a></span>
<span class=normal><a href=#__codelineno-0-365>365</a></span>
<span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span>
<span class=normal><a href=#__codelineno-0-401>401</a></span>
<span class=normal><a href=#__codelineno-0-402>402</a></span>
<span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span>
<span class=normal><a href=#__codelineno-0-415>415</a></span>
<span class=normal><a href=#__codelineno-0-416>416</a></span>
<span class=normal><a href=#__codelineno-0-417>417</a></span>
<span class=normal><a href=#__codelineno-0-418>418</a></span>
<span class=normal><a href=#__codelineno-0-419>419</a></span>
<span class=normal><a href=#__codelineno-0-420>420</a></span>
<span class=normal><a href=#__codelineno-0-421>421</a></span>
<span class=normal><a href=#__codelineno-0-422>422</a></span>
<span class=normal><a href=#__codelineno-0-423>423</a></span>
<span class=normal><a href=#__codelineno-0-424>424</a></span>
<span class=normal><a href=#__codelineno-0-425>425</a></span>
<span class=normal><a href=#__codelineno-0-426>426</a></span>
<span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span>
<span class=normal><a href=#__codelineno-0-445>445</a></span>
<span class=normal><a href=#__codelineno-0-446>446</a></span>
<span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span>
<span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span>
<span class=normal><a href=#__codelineno-0-483>483</a></span>
<span class=normal><a href=#__codelineno-0-484>484</a></span>
<span class=normal><a href=#__codelineno-0-485>485</a></span>
<span class=normal><a href=#__codelineno-0-486>486</a></span>
<span class=normal><a href=#__codelineno-0-487>487</a></span>
<span class=normal><a href=#__codelineno-0-488>488</a></span>
<span class=normal><a href=#__codelineno-0-489>489</a></span>
<span class=normal><a href=#__codelineno-0-490>490</a></span>
<span class=normal><a href=#__codelineno-0-491>491</a></span>
<span class=normal><a href=#__codelineno-0-492>492</a></span>
<span class=normal><a href=#__codelineno-0-493>493</a></span>
<span class=normal><a href=#__codelineno-0-494>494</a></span>
<span class=normal><a href=#__codelineno-0-495>495</a></span>
<span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>resolve_and_annotate_conflicts</span><span class=p>(</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>    <span class=n>packages</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Package</span><span class=p>],</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ResolutionResult</span><span class=p>:</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Resolve conflicts while strictly respecting major version boundaries.</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a><span class=sd>    Algorithm outline:</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a><span class=sd>    1. Build an *update set* mapping each package name to its</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a><span class=sd>       proposed version (``recommended_version`` if available,</span>
</span><span id=__span-0-328><a id=__codelineno-0-328 name=__codelineno-0-328></a><span class=sd>       otherwise ``current_version``). Recommended versions already</span>
</span><span id=__span-0-329><a id=__codelineno-0-329 name=__codelineno-0-329></a><span class=sd>       respect major version boundaries.</span>
</span><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><span class=sd>    2. Prefetch metadata for every package in one concurrent burst.</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><span class=sd>    3. Loop up to :data:`_MAX_RESOLUTION_ITERATIONS` times:</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=sd>       a. Scan for cross-conflicts in the current update set.</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a><span class=sd>       b. If none remain, stop  the set is self-consistent.</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a><span class=sd>       c. Attempt resolution within major version boundaries only:</span>
</span><span id=__span-0-336><a id=__codelineno-0-336 name=__codelineno-0-336></a>
</span><span id=__span-0-337><a id=__codelineno-0-337 name=__codelineno-0-337></a><span class=sd>          - Try to find a compatible source version within its current major</span>
</span><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=sd>          - If that fails, try to constrain the target within its current major</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><span class=sd>          - If both fail, revert both packages to their current versions</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>       d. Break early when no progress is made.</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=sd>    4. Annotate each :class:`Package` with its final version and any</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=sd>       unresolved :class:`Conflict` objects.</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a><span class=sd>    5. Return a :class:`ResolutionResult` with complete details.</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a><span class=sd>    Args:</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a><span class=sd>        packages: Mutable list of :class:`Package` objects. Each</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a><span class=sd>            object is updated in place with the resolved version and</span>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a><span class=sd>            conflict metadata.</span>
</span><span id=__span-0-351><a id=__codelineno-0-351 name=__codelineno-0-351></a>
</span><span id=__span-0-352><a id=__codelineno-0-352 name=__codelineno-0-352></a><span class=sd>    Returns:</span>
</span><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><span class=sd>        :class:`ResolutionResult` containing the final version for each</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><span class=sd>        package, conflict details, and resolution statistics.</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a><span class=sd>    Example::</span>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><span class=sd>        &gt;&gt;&gt; result = await analyzer.resolve_and_annotate_conflicts(pkgs)</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><span class=sd>        &gt;&gt;&gt; print(result.summary())</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><span class=sd>        &gt;&gt;&gt; for pkg_name, info in result.resolved_versions.items():</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a><span class=sd>        ...     if info.was_changed():</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a><span class=sd>        ...         print(f&quot;{pkg_name}: {info.original}  {info.resolved}&quot;)</span>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-364><a id=__codelineno-0-364 name=__codelineno-0-364></a>    <span class=c1>#  initialise update set </span>
</span><span id=__span-0-365><a id=__codelineno-0-365 name=__codelineno-0-365></a>    <span class=n>pkg_lookup</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Package</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=n>pkg</span> <span class=k>for</span> <span class=n>pkg</span> <span class=ow>in</span> <span class=n>packages</span><span class=p>}</span>
</span><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a>    <span class=n>update_set</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a>    <span class=n>conflict_tracking</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Conflict</span><span class=p>]]</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>    <span class=c1># Track original proposed versions for comparison</span>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a>    <span class=n>original_versions</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a>    <span class=k>for</span> <span class=n>pkg</span> <span class=ow>in</span> <span class=n>packages</span><span class=p>:</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>        <span class=c1># Use recommended version (which already respects major boundaries)</span>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>        <span class=n>proposed</span> <span class=o>=</span> <span class=n>pkg</span><span class=o>.</span><span class=n>recommended_version</span> <span class=ow>or</span> <span class=n>pkg</span><span class=o>.</span><span class=n>current_version</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>        <span class=n>update_set</span><span class=p>[</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>proposed</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>        <span class=n>original_versions</span><span class=p>[</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>proposed</span>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a>    <span class=c1>#  warm the cache in one round-trip </span>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>    <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>prefetch_packages</span><span class=p>([</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span> <span class=k>for</span> <span class=n>pkg</span> <span class=ow>in</span> <span class=n>packages</span><span class=p>])</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>    <span class=c1>#  iterative conflict resolution </span>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>    <span class=n>iterations_used</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>    <span class=n>converged</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>    <span class=k>for</span> <span class=n>iteration</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>_MAX_RESOLUTION_ITERATIONS</span><span class=p>):</span>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>        <span class=n>iterations_used</span> <span class=o>=</span> <span class=n>iteration</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>        <span class=n>cross_conflicts</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_find_cross_conflicts</span><span class=p>(</span><span class=n>packages</span><span class=p>,</span> <span class=n>update_set</span><span class=p>)</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>cross_conflicts</span><span class=p>:</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>            <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>                <span class=s2>&quot;Update set is conflict-free after </span><span class=si>%d</span><span class=s2> iteration(s)&quot;</span><span class=p>,</span> <span class=n>iteration</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>            <span class=p>)</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>            <span class=n>converged</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>            <span class=k>break</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>        <span class=c1># Record every conflict for later annotation (with deduplication)</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a>        <span class=k>for</span> <span class=n>conflict</span> <span class=ow>in</span> <span class=n>cross_conflicts</span><span class=p>:</span>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a>            <span class=n>conflicts_list</span> <span class=o>=</span> <span class=n>conflict_tracking</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a>                <span class=n>conflict</span><span class=o>.</span><span class=n>target_package</span><span class=p>,</span> <span class=p>[]</span>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a>            <span class=p>)</span>
</span><span id=__span-0-401><a id=__codelineno-0-401 name=__codelineno-0-401></a>
</span><span id=__span-0-402><a id=__codelineno-0-402 name=__codelineno-0-402></a>            <span class=c1># Deduplicate using conflict signature</span>
</span><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a>            <span class=n>conflict_key</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a>                <span class=n>conflict</span><span class=o>.</span><span class=n>source_package</span><span class=p>,</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a>                <span class=n>conflict</span><span class=o>.</span><span class=n>source_version</span><span class=p>,</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a>                <span class=n>conflict</span><span class=o>.</span><span class=n>required_spec</span><span class=p>,</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a>                <span class=n>conflict</span><span class=o>.</span><span class=n>conflicting_version</span><span class=p>,</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a>            <span class=p>)</span>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>            <span class=n>existing_keys</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>                <span class=p>(</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a>                    <span class=n>c</span><span class=o>.</span><span class=n>source_package</span><span class=p>,</span>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>                    <span class=n>c</span><span class=o>.</span><span class=n>source_version</span><span class=p>,</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>                    <span class=n>c</span><span class=o>.</span><span class=n>required_spec</span><span class=p>,</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>                    <span class=n>c</span><span class=o>.</span><span class=n>conflicting_version</span><span class=p>,</span>
</span><span id=__span-0-415><a id=__codelineno-0-415 name=__codelineno-0-415></a>                <span class=p>)</span>
</span><span id=__span-0-416><a id=__codelineno-0-416 name=__codelineno-0-416></a>                <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>conflicts_list</span>
</span><span id=__span-0-417><a id=__codelineno-0-417 name=__codelineno-0-417></a>            <span class=p>}</span>
</span><span id=__span-0-418><a id=__codelineno-0-418 name=__codelineno-0-418></a>            <span class=k>if</span> <span class=n>conflict_key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>existing_keys</span><span class=p>:</span>
</span><span id=__span-0-419><a id=__codelineno-0-419 name=__codelineno-0-419></a>                <span class=n>conflicts_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>conflict</span><span class=p>)</span>
</span><span id=__span-0-420><a id=__codelineno-0-420 name=__codelineno-0-420></a>
</span><span id=__span-0-421><a id=__codelineno-0-421 name=__codelineno-0-421></a>        <span class=c1># Attempt resolution while respecting major version boundaries</span>
</span><span id=__span-0-422><a id=__codelineno-0-422 name=__codelineno-0-422></a>        <span class=n>resolved_any</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_resolve_conflicts_within_major</span><span class=p>(</span>
</span><span id=__span-0-423><a id=__codelineno-0-423 name=__codelineno-0-423></a>            <span class=n>pkg_lookup</span><span class=p>,</span> <span class=n>update_set</span><span class=p>,</span> <span class=n>cross_conflicts</span>
</span><span id=__span-0-424><a id=__codelineno-0-424 name=__codelineno-0-424></a>        <span class=p>)</span>
</span><span id=__span-0-425><a id=__codelineno-0-425 name=__codelineno-0-425></a>
</span><span id=__span-0-426><a id=__codelineno-0-426 name=__codelineno-0-426></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>resolved_any</span><span class=p>:</span>
</span><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a>            <span class=c1># No version change was made  further iterations would</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a>            <span class=c1># produce the exact same conflict set; stop early.</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a>                <span class=s2>&quot;Conflict resolution stalled after </span><span class=si>%d</span><span class=s2> iteration(s)&quot;</span><span class=p>,</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>                <span class=n>iteration</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a>            <span class=p>)</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a>            <span class=k>break</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>        <span class=c1># for/else: exhausted all iterations without breaking</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>            <span class=s2>&quot;Conflict resolution did not converge within </span><span class=si>%d</span><span class=s2> iterations&quot;</span><span class=p>,</span>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>            <span class=n>_MAX_RESOLUTION_ITERATIONS</span><span class=p>,</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>        <span class=p>)</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>    <span class=c1>#  annotate packages and build resolution map </span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a>    <span class=n>resolved_versions</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>PackageResolution</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a>    <span class=n>packages_with_conflicts</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a>
</span><span id=__span-0-445><a id=__codelineno-0-445 name=__codelineno-0-445></a>    <span class=k>for</span> <span class=n>pkg</span> <span class=ow>in</span> <span class=n>packages</span><span class=p>:</span>
</span><span id=__span-0-446><a id=__codelineno-0-446 name=__codelineno-0-446></a>        <span class=n>original</span> <span class=o>=</span> <span class=n>original_versions</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a>        <span class=n>resolved</span> <span class=o>=</span> <span class=n>update_set</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a>        <span class=n>conflicts</span> <span class=o>=</span> <span class=n>conflict_tracking</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>        <span class=c1># Determine resolution status</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a>        <span class=n>status</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_determine_status</span><span class=p>(</span><span class=n>pkg</span><span class=p>,</span> <span class=n>original</span><span class=p>,</span> <span class=n>resolved</span><span class=p>,</span> <span class=n>conflicts</span><span class=p>)</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a>        <span class=c1># Find compatible alternative if there are conflicts</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a>        <span class=c1># (constrained to current major version only)</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>        <span class=n>compatible_alt</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a>        <span class=k>if</span> <span class=n>conflicts</span><span class=p>:</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a>            <span class=c1># Get current major version to constrain search</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a>            <span class=n>current_major</span> <span class=o>=</span> <span class=n>_get_major_version</span><span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>current_version</span><span class=p>)</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a>            <span class=k>if</span> <span class=n>current_major</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a>                <span class=c1># Only look within current major</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a>                <span class=n>available</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_store</span><span class=o>.</span><span class=n>get_versions</span><span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a>                <span class=n>available_in_major</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a>                    <span class=n>v</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>available</span> <span class=k>if</span> <span class=n>_get_major_version</span><span class=p>(</span><span class=n>v</span><span class=p>)</span> <span class=o>==</span> <span class=n>current_major</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a>                <span class=p>]</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a>                <span class=n>conflict_set</span> <span class=o>=</span> <span class=n>ConflictSet</span><span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>                <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>conflicts</span><span class=p>:</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>                    <span class=n>conflict_set</span><span class=o>.</span><span class=n>add_conflict</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>                <span class=n>compatible_alt</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>find_compatible_version</span><span class=p>(</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>                    <span class=n>conflict_set</span><span class=p>,</span> <span class=n>available_in_major</span><span class=p>,</span> <span class=n>pkg</span><span class=o>.</span><span class=n>current_version</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a>                <span class=p>)</span>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a>            <span class=n>packages_with_conflicts</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>        <span class=c1># Update the Package object itself</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a>        <span class=k>if</span> <span class=n>resolved</span> <span class=ow>and</span> <span class=n>resolved</span> <span class=o>!=</span> <span class=n>pkg</span><span class=o>.</span><span class=n>recommended_version</span><span class=p>:</span>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a>            <span class=c1># Only update recommended_version if resolution changed it</span>
</span><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a>            <span class=n>pkg</span><span class=o>.</span><span class=n>recommended_version</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a>                <span class=n>resolved</span> <span class=k>if</span> <span class=n>resolved</span> <span class=o>!=</span> <span class=n>pkg</span><span class=o>.</span><span class=n>current_version</span> <span class=k>else</span> <span class=n>pkg</span><span class=o>.</span><span class=n>current_version</span>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a>            <span class=p>)</span>
</span><span id=__span-0-483><a id=__codelineno-0-483 name=__codelineno-0-483></a>        <span class=k>if</span> <span class=n>conflicts</span><span class=p>:</span>
</span><span id=__span-0-484><a id=__codelineno-0-484 name=__codelineno-0-484></a>            <span class=n>pkg</span><span class=o>.</span><span class=n>set_conflicts</span><span class=p>(</span><span class=n>conflicts</span><span class=p>,</span> <span class=n>resolved_version</span><span class=o>=</span><span class=n>compatible_alt</span><span class=p>)</span>
</span><span id=__span-0-485><a id=__codelineno-0-485 name=__codelineno-0-485></a>
</span><span id=__span-0-486><a id=__codelineno-0-486 name=__codelineno-0-486></a>        <span class=c1># Store resolution details</span>
</span><span id=__span-0-487><a id=__codelineno-0-487 name=__codelineno-0-487></a>        <span class=n>resolved_versions</span><span class=p>[</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>PackageResolution</span><span class=p>(</span>
</span><span id=__span-0-488><a id=__codelineno-0-488 name=__codelineno-0-488></a>            <span class=n>name</span><span class=o>=</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span><span id=__span-0-489><a id=__codelineno-0-489 name=__codelineno-0-489></a>            <span class=n>original</span><span class=o>=</span><span class=n>original</span><span class=p>,</span>
</span><span id=__span-0-490><a id=__codelineno-0-490 name=__codelineno-0-490></a>            <span class=n>resolved</span><span class=o>=</span><span class=n>resolved</span><span class=p>,</span>
</span><span id=__span-0-491><a id=__codelineno-0-491 name=__codelineno-0-491></a>            <span class=n>status</span><span class=o>=</span><span class=n>status</span><span class=p>,</span>
</span><span id=__span-0-492><a id=__codelineno-0-492 name=__codelineno-0-492></a>            <span class=n>conflicts</span><span class=o>=</span><span class=n>conflicts</span><span class=p>,</span>
</span><span id=__span-0-493><a id=__codelineno-0-493 name=__codelineno-0-493></a>            <span class=n>compatible_alternative</span><span class=o>=</span><span class=n>compatible_alt</span><span class=p>,</span>
</span><span id=__span-0-494><a id=__codelineno-0-494 name=__codelineno-0-494></a>        <span class=p>)</span>
</span><span id=__span-0-495><a id=__codelineno-0-495 name=__codelineno-0-495></a>
</span><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a>    <span class=k>return</span> <span class=n>ResolutionResult</span><span class=p>(</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a>        <span class=n>resolved_versions</span><span class=o>=</span><span class=n>resolved_versions</span><span class=p>,</span>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a>        <span class=n>total_packages</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>packages</span><span class=p>),</span>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a>        <span class=n>packages_with_conflicts</span><span class=o>=</span><span class=n>packages_with_conflicts</span><span class=p>,</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a>        <span class=n>iterations_used</span><span class=o>=</span><span class=n>iterations_used</span><span class=p>,</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a>        <span class=n>converged</span><span class=o>=</span><span class=n>converged</span><span class=p>,</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div><hr> <h3 id=resolutionresult>ResolutionResult<a class=headerlink href=#resolutionresult title="Link to this section">&para;</a></h3> <p>Complete result of dependency conflict resolution, returned by <code>DependencyAnalyzer.resolve_and_annotate_conflicts()</code>.</p> <h4 id=attributes_1>Attributes<a class=headerlink href=#attributes_1 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Attribute</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>resolved_versions</code></td> <td><code>Dict[str, PackageResolution]</code></td> <td>Package name to resolution details</td> </tr> <tr> <td><code>total_packages</code></td> <td><code>int</code></td> <td>Total packages analyzed</td> </tr> <tr> <td><code>packages_with_conflicts</code></td> <td><code>int</code></td> <td>Packages that have conflicts</td> </tr> <tr> <td><code>iterations_used</code></td> <td><code>int</code></td> <td>Resolution iterations performed</td> </tr> <tr> <td><code>converged</code></td> <td><code>bool</code></td> <td>Whether resolution reached a stable state</td> </tr> </tbody> </table> <h4 id=methods_5>Methods<a class=headerlink href=#methods_5 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Method</th> <th>Returns</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>get_changed_packages()</code></td> <td><code>List[PackageResolution]</code></td> <td>Packages whose version was changed</td> </tr> <tr> <td><code>get_conflicts()</code></td> <td><code>List[PackageResolution]</code></td> <td>Packages with unresolved conflicts</td> </tr> <tr> <td><code>summary()</code></td> <td><code>str</code></td> <td>Human-readable resolution summary</td> </tr> </tbody> </table> <hr> <h3 id=packageresolution>PackageResolution<a class=headerlink href=#packageresolution title="Link to this section">&para;</a></h3> <p>Resolution details for a single package within a <code>ResolutionResult</code>.</p> <h4 id=attributes_2>Attributes<a class=headerlink href=#attributes_2 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Attribute</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td><code>str</code></td> <td>Package name (normalized)</td> </tr> <tr> <td><code>original</code></td> <td><code>Optional[str]</code></td> <td>Initially proposed version</td> </tr> <tr> <td><code>resolved</code></td> <td><code>Optional[str]</code></td> <td>Final version after resolution</td> </tr> <tr> <td><code>status</code></td> <td><code>ResolutionStatus</code></td> <td>Why this version was chosen</td> </tr> <tr> <td><code>conflicts</code></td> <td><code>List[Conflict]</code></td> <td>Conflicts affecting this package</td> </tr> <tr> <td><code>compatible_alternative</code></td> <td><code>Optional[str]</code></td> <td>Best alternative version, if any</td> </tr> </tbody> </table> <h4 id=resolution-statuses>Resolution Statuses<a class=headerlink href=#resolution-statuses title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Status</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>KEPT_RECOMMENDED</code></td> <td>Original recommendation was conflict-free</td> </tr> <tr> <td><code>UPGRADED</code></td> <td>Successfully upgraded to a newer version</td> </tr> <tr> <td><code>DOWNGRADED</code></td> <td>Had to downgrade due to conflicts</td> </tr> <tr> <td><code>KEPT_CURRENT</code></td> <td>No safe upgrade found; stayed at current</td> </tr> <tr> <td><code>CONSTRAINED</code></td> <td>Version was constrained by another package</td> </tr> </tbody> </table> <hr> <h2 id=models>Models<a class=headerlink href=#models title="Link to this section">&para;</a></h2> <h3 id=requirement>Requirement<a class=headerlink href=#requirement title="Link to this section">&para;</a></h3> <p>Represents a single requirement line from a requirements file.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.models</span><span class=w> </span><span class=kn>import</span> <span class=n>Requirement</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=n>req</span> <span class=o>=</span> <span class=n>Requirement</span><span class=p>(</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=n>name</span><span class=o>=</span><span class=s2>&quot;requests&quot;</span><span class=p>,</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>    <span class=n>specs</span><span class=o>=</span><span class=p>[(</span><span class=s2>&quot;&gt;=&quot;</span><span class=p>,</span> <span class=s2>&quot;2.28.0&quot;</span><span class=p>),</span> <span class=p>(</span><span class=s2>&quot;&lt;&quot;</span><span class=p>,</span> <span class=s2>&quot;3.0.0&quot;</span><span class=p>)],</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>    <span class=n>extras</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;security&quot;</span><span class=p>],</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>    <span class=n>markers</span><span class=o>=</span><span class=s2>&quot;python_version &gt;= &#39;3.8&#39;&quot;</span><span class=p>,</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=p>)</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=c1># Convert to string</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=nb>print</span><span class=p>(</span><span class=n>req</span><span class=o>.</span><span class=n>to_string</span><span class=p>())</span>  <span class=c1># requests[security]&gt;=2.28.0,&lt;3.0.0; python_version &gt;= &#39;3.8&#39;</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=c1># Update version (replaces all specifiers with &gt;=new_version)</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=n>updated</span> <span class=o>=</span> <span class=n>req</span><span class=o>.</span><span class=n>update_version</span><span class=p>(</span><span class=s2>&quot;2.31.0&quot;</span><span class=p>)</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=nb>print</span><span class=p>(</span><span class=n>updated</span><span class=p>)</span>  <span class=c1># requests[security]&gt;=2.31.0; python_version &gt;= &#39;3.8&#39;</span>
</span></code></pre></div> <h4 id=attributes_3>Attributes<a class=headerlink href=#attributes_3 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Attribute</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td><code>str</code></td> <td>Canonical package name</td> </tr> <tr> <td><code>specs</code></td> <td><code>List[Tuple[str, str]]</code></td> <td>Version specifiers (operator, version)</td> </tr> <tr> <td><code>extras</code></td> <td><code>List[str]</code></td> <td>Optional extras to install</td> </tr> <tr> <td><code>markers</code></td> <td><code>Optional[str]</code></td> <td>Environment marker expression (<abbr title="Python Enhancement Proposal">PEP</abbr> 508)</td> </tr> <tr> <td><code>url</code></td> <td><code>Optional[str]</code></td> <td>Direct <abbr title="Uniform Resource Locator">URL</abbr> or <abbr title="Version Control System">VCS</abbr> source</td> </tr> <tr> <td><code>editable</code></td> <td><code>bool</code></td> <td>Whether this is an editable install (<code>-e</code>)</td> </tr> <tr> <td><code>hashes</code></td> <td><code>List[str]</code></td> <td>Hash values for verification</td> </tr> <tr> <td><code>comment</code></td> <td><code>Optional[str]</code></td> <td>Inline comment without the <code>#</code> prefix</td> </tr> <tr> <td><code>line_number</code></td> <td><code>int</code></td> <td>Original line number in the source file</td> </tr> <tr> <td><code>raw_line</code></td> <td><code>Optional[str]</code></td> <td>Original unmodified line text</td> </tr> </tbody> </table> <h4 id=methods_6>Methods<a class=headerlink href=#methods_6 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Method</th> <th>Returns</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>to_string(include_hashes=True, include_comment=True)</code></td> <td><code>str</code></td> <td>Render canonical <code>requirements.txt</code> representation</td> </tr> <tr> <td><code>update_version(new_version)</code></td> <td><code>str</code></td> <td>Return requirement string updated to a new version</td> </tr> </tbody> </table> <hr> <h3 id=package>Package<a class=headerlink href=#package title="Link to this section">&para;</a></h3> <p>Represents a Python package with version state, update recommendations, and conflict tracking.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.models</span><span class=w> </span><span class=kn>import</span> <span class=n>Package</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=n>pkg</span> <span class=o>=</span> <span class=n>Package</span><span class=p>(</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=n>name</span><span class=o>=</span><span class=s2>&quot;requests&quot;</span><span class=p>,</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>    <span class=n>current_version</span><span class=o>=</span><span class=s2>&quot;2.28.0&quot;</span><span class=p>,</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>    <span class=n>latest_version</span><span class=o>=</span><span class=s2>&quot;2.32.0&quot;</span><span class=p>,</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>    <span class=n>recommended_version</span><span class=o>=</span><span class=s2>&quot;2.32.0&quot;</span><span class=p>,</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=p>)</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=c1># Check status</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=nb>print</span><span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>has_update</span><span class=p>())</span>        <span class=c1># True</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=nb>print</span><span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>requires_downgrade</span><span class=p>)</span>  <span class=c1># False</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=nb>print</span><span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>has_conflicts</span><span class=p>())</span>     <span class=c1># False</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=c1># Serialization</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=nb>print</span><span class=p>(</span><span class=n>pkg</span><span class=o>.</span><span class=n>to_json</span><span class=p>())</span>
</span></code></pre></div> <h4 id=attributes_4>Attributes<a class=headerlink href=#attributes_4 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Attribute</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td><code>str</code></td> <td>Normalized package name (<abbr title="Python Enhancement Proposal">PEP</abbr> 503)</td> </tr> <tr> <td><code>current_version</code></td> <td><code>Optional[str]</code></td> <td>Currently installed or specified version</td> </tr> <tr> <td><code>latest_version</code></td> <td><code>Optional[str]</code></td> <td>Latest version on <abbr title="Python Package Index">PyPI</abbr> (informational)</td> </tr> <tr> <td><code>recommended_version</code></td> <td><code>Optional[str]</code></td> <td>Safe upgrade version within major boundary</td> </tr> <tr> <td><code>metadata</code></td> <td><code>Dict[str, Any]</code></td> <td>Package metadata from <abbr title="Python Package Index">PyPI</abbr></td> </tr> <tr> <td><code>conflicts</code></td> <td><code>List[Conflict]</code></td> <td>Dependency conflicts affecting this package</td> </tr> </tbody> </table> <h4 id=properties-and-methods>Properties and Methods<a class=headerlink href=#properties-and-methods title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Member</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>current</code></td> <td><code>Optional[Version]</code></td> <td>Parsed current version</td> </tr> <tr> <td><code>latest</code></td> <td><code>Optional[Version]</code></td> <td>Parsed latest version</td> </tr> <tr> <td><code>recommended</code></td> <td><code>Optional[Version]</code></td> <td>Parsed recommended version</td> </tr> <tr> <td><code>requires_downgrade</code></td> <td><code>bool</code></td> <td>True if recommended version is lower than current</td> </tr> <tr> <td><code>has_update()</code></td> <td><code>bool</code></td> <td>True if recommended version is newer than current</td> </tr> <tr> <td><code>has_conflicts()</code></td> <td><code>bool</code></td> <td>True if dependency conflicts exist</td> </tr> <tr> <td><code>set_conflicts(conflicts, resolved_version=None)</code></td> <td><code>None</code></td> <td>Set conflicts and optionally update recommended version</td> </tr> <tr> <td><code>get_conflict_summary()</code></td> <td><code>List[str]</code></td> <td>Short, user-friendly conflict summaries</td> </tr> <tr> <td><code>get_conflict_details()</code></td> <td><code>List[str]</code></td> <td>Detailed conflict descriptions</td> </tr> <tr> <td><code>get_status_summary()</code></td> <td><code>Tuple[str, str, str, Optional[str]]</code></td> <td>Status, installed, latest, recommended</td> </tr> <tr> <td><code>to_json()</code></td> <td><code>Dict[str, Any]</code></td> <td><abbr title="JavaScript Object Notation">JSON</abbr>-safe package representation</td> </tr> </tbody> </table> <hr> <h3 id=conflict>Conflict<a class=headerlink href=#conflict title="Link to this section">&para;</a></h3> <p>Represents a dependency conflict between two packages. This is a frozen dataclass (immutable after creation).</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.models</span><span class=w> </span><span class=kn>import</span> <span class=n>Conflict</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=n>conflict</span> <span class=o>=</span> <span class=n>Conflict</span><span class=p>(</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    <span class=n>source_package</span><span class=o>=</span><span class=s2>&quot;flask&quot;</span><span class=p>,</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=n>target_package</span><span class=o>=</span><span class=s2>&quot;werkzeug&quot;</span><span class=p>,</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>    <span class=n>required_spec</span><span class=o>=</span><span class=s2>&quot;&gt;=2.0,&lt;3.0&quot;</span><span class=p>,</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>    <span class=n>conflicting_version</span><span class=o>=</span><span class=s2>&quot;3.0.0&quot;</span><span class=p>,</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=n>source_version</span><span class=o>=</span><span class=s2>&quot;2.3.0&quot;</span><span class=p>,</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=p>)</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=nb>print</span><span class=p>(</span><span class=n>conflict</span><span class=o>.</span><span class=n>to_display_string</span><span class=p>())</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=c1># flask==2.3.0 requires werkzeug&gt;=2.0,&lt;3.0</span>
</span></code></pre></div> <h4 id=attributes_5>Attributes<a class=headerlink href=#attributes_5 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Attribute</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>source_package</code></td> <td><code>str</code></td> <td>Package declaring the dependency</td> </tr> <tr> <td><code>target_package</code></td> <td><code>str</code></td> <td>Package being constrained</td> </tr> <tr> <td><code>required_spec</code></td> <td><code>str</code></td> <td>Version specifier required by the source</td> </tr> <tr> <td><code>conflicting_version</code></td> <td><code>str</code></td> <td>Version that violates the requirement</td> </tr> <tr> <td><code>source_version</code></td> <td><code>Optional[str]</code></td> <td>Version of the source package</td> </tr> </tbody> </table> <h4 id=methods_7>Methods<a class=headerlink href=#methods_7 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Method</th> <th>Returns</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>to_display_string()</code></td> <td><code>str</code></td> <td>Human-readable conflict description</td> </tr> <tr> <td><code>to_short_string()</code></td> <td><code>str</code></td> <td>Compact conflict summary</td> </tr> <tr> <td><code>to_json()</code></td> <td><code>Dict[str, Optional[str]]</code></td> <td><abbr title="JavaScript Object Notation">JSON</abbr>-serializable representation</td> </tr> </tbody> </table> <hr> <h3 id=conflictset>ConflictSet<a class=headerlink href=#conflictset title="Link to this section">&para;</a></h3> <p>Collection of conflicts affecting a single package. Provides utilities to find compatible versions.</p> <h4 id=attributes_6>Attributes<a class=headerlink href=#attributes_6 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Attribute</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>package_name</code></td> <td><code>str</code></td> <td>Name of the affected package</td> </tr> <tr> <td><code>conflicts</code></td> <td><code>List[Conflict]</code></td> <td>Conflicts associated with this package</td> </tr> </tbody> </table> <h4 id=methods_8>Methods<a class=headerlink href=#methods_8 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Method</th> <th>Returns</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>add_conflict(conflict)</code></td> <td><code>None</code></td> <td>Add a conflict to the set</td> </tr> <tr> <td><code>has_conflicts()</code></td> <td><code>bool</code></td> <td>True if any conflicts exist</td> </tr> <tr> <td><code>get_max_compatible_version(available_versions)</code></td> <td><code>Optional[str]</code></td> <td>Highest version compatible with all conflicts</td> </tr> </tbody> </table> <hr> <h2 id=utilities>Utilities<a class=headerlink href=#utilities title="Link to this section">&para;</a></h2> <h3 id=httpclient>HTTPClient<a class=headerlink href=#httpclient title="Link to this section">&para;</a></h3> <p>Async <abbr title="Hypertext Transfer Protocol">HTTP</abbr> client with retry logic, rate limiting, concurrency control, and <abbr title="Python Package Index">PyPI</abbr>-specific error handling. Uses httpx with <abbr title="Hypertext Transfer Protocol">HTTP</abbr>/2 support.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>HTTPClient</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>main</span><span class=p>():</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>    <span class=k>async</span> <span class=k>with</span> <span class=n>HTTPClient</span><span class=p>(</span><span class=n>timeout</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span> <span class=n>max_retries</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span> <span class=k>as</span> <span class=n>http</span><span class=p>:</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>        <span class=c1># GET request</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>        <span class=n>response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>http</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;https://pypi.org/pypi/requests/json&quot;</span><span class=p>)</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>        <span class=c1># GET with JSON parsing</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>        <span class=n>data</span> <span class=o>=</span> <span class=k>await</span> <span class=n>http</span><span class=o>.</span><span class=n>get_json</span><span class=p>(</span><span class=s2>&quot;https://pypi.org/pypi/requests/json&quot;</span><span class=p>)</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>        <span class=c1># Batch concurrent JSON fetches</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>http</span><span class=o>.</span><span class=n>batch_get_json</span><span class=p>([</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>            <span class=s2>&quot;https://pypi.org/pypi/flask/json&quot;</span><span class=p>,</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>            <span class=s2>&quot;https://pypi.org/pypi/click/json&quot;</span><span class=p>,</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>        <span class=p>])</span>
</span></code></pre></div> <h4 id=constructor-parameters_2>Constructor Parameters<a class=headerlink href=#constructor-parameters_2 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Parameter</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>timeout</code></td> <td><code>int</code></td> <td><code>30</code></td> <td>Request timeout in seconds</td> </tr> <tr> <td><code>max_retries</code></td> <td><code>int</code></td> <td><code>3</code></td> <td>Maximum retry attempts</td> </tr> <tr> <td><code>rate_limit_delay</code></td> <td><code>float</code></td> <td><code>0.0</code></td> <td>Minimum delay between requests</td> </tr> <tr> <td><code>verify_ssl</code></td> <td><code>bool</code></td> <td><code>True</code></td> <td>Verify SSL certificates</td> </tr> <tr> <td><code>user_agent</code></td> <td><code>Optional[str]</code></td> <td>Auto-generated</td> <td>Custom User-Agent header</td> </tr> <tr> <td><code>max_concurrency</code></td> <td><code>int</code></td> <td><code>10</code></td> <td>Maximum concurrent requests</td> </tr> </tbody> </table> <h4 id=methods_9>Methods<a class=headerlink href=#methods_9 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Method</th> <th>Returns</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>get(url)</code></td> <td><code>httpx.Response</code></td> <td>GET request with retry logic</td> </tr> <tr> <td><code>post(url)</code></td> <td><code>httpx.Response</code></td> <td>POST request with retry logic</td> </tr> <tr> <td><code>get_json(url)</code></td> <td><code>Dict[str, Any]</code></td> <td>GET and parse <abbr title="JavaScript Object Notation">JSON</abbr> response</td> </tr> <tr> <td><code>batch_get_json(urls)</code></td> <td><code>Dict[str, Dict[str, Any]]</code></td> <td>Concurrent <abbr title="JavaScript Object Notation">JSON</abbr> fetches</td> </tr> <tr> <td><code>close()</code></td> <td><code>None</code></td> <td>Close the <abbr title="Hypertext Transfer Protocol">HTTP</abbr> client</td> </tr> </tbody> </table> <hr> <h3 id=console-utilities>Console Utilities<a class=headerlink href=#console-utilities title="Link to this section">&para;</a></h3> <p>User-facing output helpers built on the Rich library.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.utils</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>    <span class=n>print_success</span><span class=p>,</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>    <span class=n>print_error</span><span class=p>,</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>    <span class=n>print_warning</span><span class=p>,</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>    <span class=n>print_table</span><span class=p>,</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>    <span class=n>confirm</span><span class=p>,</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>    <span class=n>get_raw_console</span><span class=p>,</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=p>)</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=c1># Status messages</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=n>print_success</span><span class=p>(</span><span class=s2>&quot;Operation completed!&quot;</span><span class=p>)</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=n>print_error</span><span class=p>(</span><span class=s2>&quot;Something went wrong&quot;</span><span class=p>)</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=n>print_warning</span><span class=p>(</span><span class=s2>&quot;Proceed with caution&quot;</span><span class=p>)</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=c1># Rich table from list of dicts</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=n>print_table</span><span class=p>(</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>    <span class=n>data</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>        <span class=p>{</span><span class=s2>&quot;Name&quot;</span><span class=p>:</span> <span class=s2>&quot;requests&quot;</span><span class=p>,</span> <span class=s2>&quot;Version&quot;</span><span class=p>:</span> <span class=s2>&quot;2.31.0&quot;</span><span class=p>},</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>        <span class=p>{</span><span class=s2>&quot;Name&quot;</span><span class=p>:</span> <span class=s2>&quot;flask&quot;</span><span class=p>,</span> <span class=s2>&quot;Version&quot;</span><span class=p>:</span> <span class=s2>&quot;2.3.3&quot;</span><span class=p>},</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>    <span class=p>],</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a>    <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Packages&quot;</span><span class=p>,</span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a><span class=p>)</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a><span class=c1># User confirmation prompt</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a><span class=k>if</span> <span class=n>confirm</span><span class=p>(</span><span class=s2>&quot;Apply 5 updates?&quot;</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Applying...&quot;</span><span class=p>)</span>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a><span class=c1># Access underlying Rich Console</span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a><span class=n>console</span> <span class=o>=</span> <span class=n>get_raw_console</span><span class=p>()</span>
</span></code></pre></div> <h4 id=functions>Functions<a class=headerlink href=#functions title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Function</th> <th>Parameters</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>print_success(message, prefix="[OK]")</code></td> <td><code>str</code></td> <td>Print a styled success message</td> </tr> <tr> <td><code>print_error(message, prefix="[ERROR]")</code></td> <td><code>str</code></td> <td>Print a styled error message</td> </tr> <tr> <td><code>print_warning(message, prefix="[WARNING]")</code></td> <td><code>str</code></td> <td>Print a styled warning message</td> </tr> <tr> <td><code>print_table(data, headers=None, title=None, ...)</code></td> <td><code>List[Dict]</code></td> <td>Render data as a Rich table</td> </tr> <tr> <td><code>confirm(message, default=False)</code></td> <td><code>str, bool</code></td> <td>Prompt for yes/no confirmation</td> </tr> <tr> <td><code>get_raw_console()</code></td> <td></td> <td>Return the underlying Rich Console instance</td> </tr> <tr> <td><code>reconfigure_console()</code></td> <td><code>None</code></td> <td>Reset the global console (useful after changing <code>NO_COLOR</code>)</td> </tr> <tr> <td><code>colorize_update_type(update_type)</code></td> <td><code>str</code></td> <td>Return Rich-markup colored update type label</td> </tr> </tbody> </table> <hr> <h3 id=filesystem-utilities>Filesystem Utilities<a class=headerlink href=#filesystem-utilities title="Link to this section">&para;</a></h3> <p>Safe file I/O helpers with backup, restore, and path validation support.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.utils</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=n>safe_read_file</span><span class=p>,</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>    <span class=n>safe_write_file</span><span class=p>,</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>    <span class=n>create_backup</span><span class=p>,</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>    <span class=n>restore_backup</span><span class=p>,</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>    <span class=n>create_timestamped_backup</span><span class=p>,</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=n>find_requirements_files</span><span class=p>,</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>    <span class=n>validate_path</span><span class=p>,</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=p>)</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=c1># Read a file safely (with size limit)</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=n>content</span> <span class=o>=</span> <span class=n>safe_read_file</span><span class=p>(</span><span class=s2>&quot;requirements.txt&quot;</span><span class=p>)</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=c1># Write with automatic backup</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=n>backup_path</span> <span class=o>=</span> <span class=n>safe_write_file</span><span class=p>(</span><span class=s2>&quot;requirements.txt&quot;</span><span class=p>,</span> <span class=n>new_content</span><span class=p>,</span> <span class=n>create_backup</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=c1># Find all requirements files in a directory</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=n>files</span> <span class=o>=</span> <span class=n>find_requirements_files</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>,</span> <span class=n>recursive</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-10-19><a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a>
</span><span id=__span-10-20><a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a><span class=c1># Validate a path stays within a base directory</span>
</span><span id=__span-10-21><a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=n>resolved</span> <span class=o>=</span> <span class=n>validate_path</span><span class=p>(</span><span class=s2>&quot;../requirements.txt&quot;</span><span class=p>,</span> <span class=n>base_dir</span><span class=o>=</span><span class=s2>&quot;/project&quot;</span><span class=p>)</span>
</span></code></pre></div> <h4 id=functions_1>Functions<a class=headerlink href=#functions_1 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Function</th> <th>Returns</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>safe_read_file(file_path, max_size=None, encoding="utf-8")</code></td> <td><code>str</code></td> <td>Read a text file with optional size limit</td> </tr> <tr> <td><code>safe_write_file(file_path, content, create_backup=True)</code></td> <td><code>Optional[Path]</code></td> <td>Atomic write with optional backup; returns backup path</td> </tr> <tr> <td><code>create_backup(file_path)</code></td> <td><code>Path</code></td> <td>Create a timestamped backup of a file</td> </tr> <tr> <td><code>restore_backup(backup_path, target_path=None)</code></td> <td><code>None</code></td> <td>Restore a file from a backup</td> </tr> <tr> <td><code>create_timestamped_backup(file_path)</code></td> <td><code>Path</code></td> <td>Create a backup with <code>{stem}.{timestamp}.backup{suffix}</code> format</td> </tr> <tr> <td><code>find_requirements_files(directory=".", recursive=True)</code></td> <td><code>List[Path]</code></td> <td>Find requirements files in a directory</td> </tr> <tr> <td><code>validate_path(path, base_dir=None)</code></td> <td><code>Path</code></td> <td>Resolve and validate a path; raises <code>FileOperationError</code> if outside <code>base_dir</code></td> </tr> </tbody> </table> <hr> <h3 id=logging-utilities>Logging Utilities<a class=headerlink href=#logging-utilities title="Link to this section">&para;</a></h3> <p>Centralized logging setup for depkeeper.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.utils</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>    <span class=n>get_logger</span><span class=p>,</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>    <span class=n>setup_logging</span><span class=p>,</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>    <span class=n>disable_logging</span><span class=p>,</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>    <span class=n>is_logging_configured</span><span class=p>,</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=p>)</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=c1># Get a named logger</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=n>logger</span> <span class=o>=</span> <span class=n>get_logger</span><span class=p>(</span><span class=s2>&quot;my_module&quot;</span><span class=p>)</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Processing started&quot;</span><span class=p>)</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=c1># Configure logging level</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=n>setup_logging</span><span class=p>(</span><span class=n>verbosity</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>  <span class=c1># DEBUG level</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=c1># Check if logging has been configured</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=k>if</span> <span class=ow>not</span> <span class=n>is_logging_configured</span><span class=p>():</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>    <span class=n>setup_logging</span><span class=p>(</span><span class=n>verbosity</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a><span class=c1># Suppress all logging output</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=n>disable_logging</span><span class=p>()</span>
</span></code></pre></div> <h4 id=functions_2>Functions<a class=headerlink href=#functions_2 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Function</th> <th>Returns</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>get_logger(name=None)</code></td> <td><code>logging.Logger</code></td> <td>Get a named logger under the <code>depkeeper</code> namespace</td> </tr> <tr> <td><code>setup_logging(verbosity=0)</code></td> <td><code>None</code></td> <td>Configure logging level (0=WARNING, 1=INFO, 2=DEBUG)</td> </tr> <tr> <td><code>is_logging_configured()</code></td> <td><code>bool</code></td> <td>Check if logging has already been set up</td> </tr> <tr> <td><code>disable_logging()</code></td> <td><code>None</code></td> <td>Suppress all depkeeper log output</td> </tr> </tbody> </table> <hr> <h3 id=version-utilities>Version Utilities<a class=headerlink href=#version-utilities title="Link to this section">&para;</a></h3> <p>Helpers for classifying version changes using <abbr title="Python Enhancement Proposal">PEP</abbr> 440 parsing.</p> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>get_update_type</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=n>get_update_type</span><span class=p>(</span><span class=s2>&quot;1.0.0&quot;</span><span class=p>,</span> <span class=s2>&quot;2.0.0&quot;</span><span class=p>)</span>   <span class=c1># &quot;major&quot;</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=n>get_update_type</span><span class=p>(</span><span class=s2>&quot;1.0.0&quot;</span><span class=p>,</span> <span class=s2>&quot;1.1.0&quot;</span><span class=p>)</span>   <span class=c1># &quot;minor&quot;</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=n>get_update_type</span><span class=p>(</span><span class=s2>&quot;1.0.0&quot;</span><span class=p>,</span> <span class=s2>&quot;1.0.1&quot;</span><span class=p>)</span>   <span class=c1># &quot;patch&quot;</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=n>get_update_type</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=s2>&quot;1.0.0&quot;</span><span class=p>)</span>       <span class=c1># &quot;new&quot;</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=n>get_update_type</span><span class=p>(</span><span class=s2>&quot;1.0.0&quot;</span><span class=p>,</span> <span class=s2>&quot;1.0.0&quot;</span><span class=p>)</span>   <span class=c1># &quot;same&quot;</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=n>get_update_type</span><span class=p>(</span><span class=s2>&quot;2.0.0&quot;</span><span class=p>,</span> <span class=s2>&quot;1.0.0&quot;</span><span class=p>)</span>   <span class=c1># &quot;downgrade&quot;</span>
</span></code></pre></div> <h4 id=functions_3>Functions<a class=headerlink href=#functions_3 title="Link to this section">&para;</a></h4> <table> <thead> <tr> <th>Function</th> <th>Returns</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>get_update_type(current_version, target_version)</code></td> <td><code>str</code></td> <td>Classify the update type between two versions</td> </tr> </tbody> </table> <p>Return values: <code>"major"</code>, <code>"minor"</code>, <code>"patch"</code>, <code>"new"</code>, <code>"same"</code>, <code>"downgrade"</code>, <code>"update"</code>, <code>"unknown"</code></p> <hr> <h3 id=exceptions>Exceptions<a class=headerlink href=#exceptions title="Link to this section">&para;</a></h3> <p>All exceptions inherit from <code>DepKeeperError</code> and support structured metadata via the <code>details</code> attribute.</p> <p><strong>Exception hierarchy:</strong></p> <ul> <li><code>DepKeeperError</code> (base)<ul> <li><code>ParseError</code></li> <li><code>NetworkError</code><ul> <li><code>PyPIError</code></li> </ul> </li> <li><code>FileOperationError</code></li> </ul> </li> </ul> <table> <thead> <tr> <th>Exception</th> <th>Description</th> <th>Key Attributes</th> </tr> </thead> <tbody> <tr> <td><code>DepKeeperError</code></td> <td>Base exception for all depkeeper errors</td> <td><code>message</code>, <code>details</code></td> </tr> <tr> <td><code>ParseError</code></td> <td>Requirements file parsing failures</td> <td><code>line_number</code>, <code>line_content</code>, <code>file_path</code></td> </tr> <tr> <td><code>NetworkError</code></td> <td><abbr title="Hypertext Transfer Protocol">HTTP</abbr> or network operation failures</td> <td><code>url</code>, <code>status_code</code>, <code>response_body</code></td> </tr> <tr> <td><code>PyPIError</code></td> <td><abbr title="Python Package Index">PyPI</abbr> <abbr title="Application Programming Interface">API</abbr>-specific failures</td> <td><code>package_name</code> (inherits <code>NetworkError</code>)</td> </tr> <tr> <td><code>FileOperationError</code></td> <td>File system operation failures</td> <td><code>file_path</code>, <code>operation</code>, <code>original_error</code></td> </tr> </tbody> </table> <hr> <h2 id=complete-example>Complete Example<a class=headerlink href=#complete-example title="Link to this section">&para;</a></h2> <div class="language-python highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=ch>#!/usr/bin/env python3</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=sd>&quot;&quot;&quot;Check and update dependencies programmatically.&quot;&quot;&quot;</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=kn>import</span><span class=w> </span><span class=nn>asyncio</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.core</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>    <span class=n>RequirementsParser</span><span class=p>,</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>    <span class=n>VersionChecker</span><span class=p>,</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>    <span class=n>DependencyAnalyzer</span><span class=p>,</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>    <span class=n>PyPIDataStore</span><span class=p>,</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=p>)</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=kn>from</span><span class=w> </span><span class=nn>depkeeper.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>HTTPClient</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>analyze_requirements</span><span class=p>(</span><span class=n>file_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Analyze a requirements file and report on updates.&quot;&quot;&quot;</span>
</span><span id=__span-13-17><a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>
</span><span id=__span-13-18><a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>    <span class=c1># Step 1: Parse requirements</span>
</span><span id=__span-13-19><a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a>    <span class=n>parser</span> <span class=o>=</span> <span class=n>RequirementsParser</span><span class=p>()</span>
</span><span id=__span-13-20><a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>    <span class=n>requirements</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_file</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span><span id=__span-13-21><a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Found </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>requirements</span><span class=p>)</span><span class=si>}</span><span class=s2> packages</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-13-22><a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>
</span><span id=__span-13-23><a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a>    <span class=k>async</span> <span class=k>with</span> <span class=n>HTTPClient</span><span class=p>()</span> <span class=k>as</span> <span class=n>http</span><span class=p>:</span>
</span><span id=__span-13-24><a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>        <span class=c1># Step 2: Create shared data store</span>
</span><span id=__span-13-25><a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a>        <span class=n>store</span> <span class=o>=</span> <span class=n>PyPIDataStore</span><span class=p>(</span><span class=n>http</span><span class=p>)</span>
</span><span id=__span-13-26><a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>
</span><span id=__span-13-27><a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a>        <span class=c1># Step 3: Check versions</span>
</span><span id=__span-13-28><a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a>        <span class=n>checker</span> <span class=o>=</span> <span class=n>VersionChecker</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=n>store</span><span class=p>)</span>
</span><span id=__span-13-29><a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a>        <span class=n>packages</span> <span class=o>=</span> <span class=k>await</span> <span class=n>checker</span><span class=o>.</span><span class=n>check_packages</span><span class=p>(</span><span class=n>requirements</span><span class=p>)</span>
</span><span id=__span-13-30><a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a>
</span><span id=__span-13-31><a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a>        <span class=c1># Step 4: Resolve conflicts</span>
</span><span id=__span-13-32><a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a>        <span class=n>analyzer</span> <span class=o>=</span> <span class=n>DependencyAnalyzer</span><span class=p>(</span><span class=n>data_store</span><span class=o>=</span><span class=n>store</span><span class=p>)</span>
</span><span id=__span-13-33><a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a>        <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>analyzer</span><span class=o>.</span><span class=n>resolve_and_annotate_conflicts</span><span class=p>(</span><span class=n>packages</span><span class=p>)</span>
</span><span id=__span-13-34><a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a>
</span><span id=__span-13-35><a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a>        <span class=c1># Step 5: Report results</span>
</span><span id=__span-13-36><a id=__codelineno-13-36 name=__codelineno-13-36 href=#__codelineno-13-36></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Converged: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>converged</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>iterations_used</span><span class=si>}</span><span class=s2> iterations)&quot;</span><span class=p>)</span>
</span><span id=__span-13-37><a id=__codelineno-13-37 name=__codelineno-13-37 href=#__codelineno-13-37></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Conflicts: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>packages_with_conflicts</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-13-38><a id=__codelineno-13-38 name=__codelineno-13-38 href=#__codelineno-13-38></a>
</span><span id=__span-13-39><a id=__codelineno-13-39 name=__codelineno-13-39 href=#__codelineno-13-39></a>        <span class=k>for</span> <span class=n>pkg</span> <span class=ow>in</span> <span class=n>packages</span><span class=p>:</span>
</span><span id=__span-13-40><a id=__codelineno-13-40 name=__codelineno-13-40 href=#__codelineno-13-40></a>            <span class=k>if</span> <span class=n>pkg</span><span class=o>.</span><span class=n>has_update</span><span class=p>():</span>
</span><span id=__span-13-41><a id=__codelineno-13-41 name=__codelineno-13-41 href=#__codelineno-13-41></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>pkg</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>pkg</span><span class=o>.</span><span class=n>current_version</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=n>pkg</span><span class=o>.</span><span class=n>recommended_version</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-13-42><a id=__codelineno-13-42 name=__codelineno-13-42 href=#__codelineno-13-42></a>
</span><span id=__span-13-43><a id=__codelineno-13-43 name=__codelineno-13-43 href=#__codelineno-13-43></a>    <span class=k>return</span> <span class=n>packages</span>
</span><span id=__span-13-44><a id=__codelineno-13-44 name=__codelineno-13-44 href=#__codelineno-13-44></a>
</span><span id=__span-13-45><a id=__codelineno-13-45 name=__codelineno-13-45 href=#__codelineno-13-45></a>
</span><span id=__span-13-46><a id=__codelineno-13-46 name=__codelineno-13-46 href=#__codelineno-13-46></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
</span><span id=__span-13-47><a id=__codelineno-13-47 name=__codelineno-13-47 href=#__codelineno-13-47></a>    <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>analyze_requirements</span><span class=p>(</span><span class=s2>&quot;requirements.txt&quot;</span><span class=p>))</span>
</span></code></pre></div> <hr> <h2 id=see-also>See Also<a class=headerlink href=#see-also title="Link to this section">&para;</a></h2> <ul> <li><a href=../../getting-started/quickstart/ >Getting Started</a> -- Quick start guide</li> <li><a href=../cli-commands/ ><abbr title="Command Line Interface">CLI</abbr> Reference</a> -- Command-line interface</li> <li><a href=../../contributing/development-setup/ >Contributing</a> -- Development guide</li> </ul> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../cli-commands/ class="md-footer__link md-footer__link--prev" aria-label="Previous: CLI Commands"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> CLI Commands </div> </div> </a> <a href=../configuration-options/ class="md-footer__link md-footer__link--next" aria-label="Next: Configuration Options"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Configuration Options </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024-2026 Rahul Kaushal </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/rahulkaushal04/depkeeper target=_blank rel=noopener title="depkeeper on GitHub" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://pypi.org/project/depkeeper/ target=_blank rel=noopener title="depkeeper on PyPI" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg> </a> <a href=https://github.com/rahulkaushal04/depkeeper/issues target=_blank rel=noopener title="Report an issue" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M192 96c0-53 43-96 96-96s96 43 96 96v3.6c0 15.7-12.7 28.4-28.4 28.4H220.5c-15.7 0-28.4-12.7-28.4-28.4V96zm345.6 12.8c10.6 14.1 7.7 34.2-6.4 44.8l-97.8 73.3c5.3 8.9 9.3 18.7 11.8 29.1H544c17.7 0 32 14.3 32 32s-14.3 32-32 32h-96v32c0 2.6-.1 5.3-.2 7.9l83.4 62.5c14.1 10.6 17 30.7 6.4 44.8s-30.7 17-44.8 6.4l-63.1-47.3c-23.2 44.2-66.5 76.2-117.7 83.9V280c0-13.3-10.7-24-24-24s-24 10.7-24 24v230.2c-51.2-7.7-94.5-39.7-117.7-83.9l-63.1 47.3c-14.1 10.6-34.2 7.7-44.8-6.4s-7.7-34.2 6.4-44.8l83.4-62.5c-.1-2.6-.2-5.2-.2-7.9v-32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32h98.8c2.5-10.4 6.5-20.2 11.8-29.1l-97.8-73.3c-14.1-10.6-17-30.7-6.4-44.8s30.7-17 44.8-6.4L192 184c12.3-5.1 25.8-8 40-8h112c14.2 0 27.7 2.8 40 8l108.8-81.6c14.1-10.6 34.2-7.7 44.8 6.4"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.top", "navigation.footer", "navigation.indexes", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link", "content.tooltips", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=../../javascripts/extra.js></script> </body> </html>